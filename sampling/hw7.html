<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>抽样调查第七周作业</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.c81839fd.js" as="script"><link rel="preload" href="/assets/js/2.1ffc7243.js" as="script"><link rel="preload" href="/assets/js/1.21765641.js" as="script"><link rel="preload" href="/assets/js/24.922a5ac7.js" as="script"><link rel="prefetch" href="/assets/js/10.94d9ae37.js"><link rel="prefetch" href="/assets/js/11.f71277c4.js"><link rel="prefetch" href="/assets/js/12.df91b8c5.js"><link rel="prefetch" href="/assets/js/13.ccf34248.js"><link rel="prefetch" href="/assets/js/14.cec430ee.js"><link rel="prefetch" href="/assets/js/15.075f2557.js"><link rel="prefetch" href="/assets/js/16.050b0744.js"><link rel="prefetch" href="/assets/js/17.e6b2d62e.js"><link rel="prefetch" href="/assets/js/18.e1f699c1.js"><link rel="prefetch" href="/assets/js/19.43923341.js"><link rel="prefetch" href="/assets/js/20.b20e711d.js"><link rel="prefetch" href="/assets/js/21.8dd3e2d2.js"><link rel="prefetch" href="/assets/js/22.bfe29ee7.js"><link rel="prefetch" href="/assets/js/23.d6610626.js"><link rel="prefetch" href="/assets/js/25.082050c9.js"><link rel="prefetch" href="/assets/js/26.64d32bef.js"><link rel="prefetch" href="/assets/js/27.429314cf.js"><link rel="prefetch" href="/assets/js/28.6d085cc4.js"><link rel="prefetch" href="/assets/js/29.03a256fd.js"><link rel="prefetch" href="/assets/js/3.689860d5.js"><link rel="prefetch" href="/assets/js/30.1af4f8c4.js"><link rel="prefetch" href="/assets/js/31.5eec4937.js"><link rel="prefetch" href="/assets/js/32.b31e0c94.js"><link rel="prefetch" href="/assets/js/33.0057f8d5.js"><link rel="prefetch" href="/assets/js/34.1c144145.js"><link rel="prefetch" href="/assets/js/35.997e4046.js"><link rel="prefetch" href="/assets/js/36.73c2dac3.js"><link rel="prefetch" href="/assets/js/37.0efd73ec.js"><link rel="prefetch" href="/assets/js/38.d3b0fd9d.js"><link rel="prefetch" href="/assets/js/39.1f488157.js"><link rel="prefetch" href="/assets/js/4.8c775bf3.js"><link rel="prefetch" href="/assets/js/40.3f735ee0.js"><link rel="prefetch" href="/assets/js/41.0b3072ca.js"><link rel="prefetch" href="/assets/js/42.f2deac56.js"><link rel="prefetch" href="/assets/js/43.2925ac95.js"><link rel="prefetch" href="/assets/js/44.15b774a6.js"><link rel="prefetch" href="/assets/js/45.4a73b893.js"><link rel="prefetch" href="/assets/js/46.ff126056.js"><link rel="prefetch" href="/assets/js/47.a8af33bb.js"><link rel="prefetch" href="/assets/js/48.fd9bfbfb.js"><link rel="prefetch" href="/assets/js/49.d1bb8a6b.js"><link rel="prefetch" href="/assets/js/5.4038169b.js"><link rel="prefetch" href="/assets/js/50.261e0b1b.js"><link rel="prefetch" href="/assets/js/51.ad5e908a.js"><link rel="prefetch" href="/assets/js/52.30dae559.js"><link rel="prefetch" href="/assets/js/53.5928da48.js"><link rel="prefetch" href="/assets/js/54.b392dbf9.js"><link rel="prefetch" href="/assets/js/55.02dbfb4e.js"><link rel="prefetch" href="/assets/js/6.bdb8c543.js"><link rel="prefetch" href="/assets/js/7.7ea37c1e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.be90ab07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>抽样调查第七周作业</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sampling/hw7.html#第四章补充题3" class="sidebar-link">第四章补充题3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw7.html#_1" class="sidebar-link">1</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#_2" class="sidebar-link">2</a></li></ul></li><li><a href="/sampling/hw7.html#_4-8-3" class="sidebar-link">4.8.3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw7.html#a" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#b" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#c" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#d" class="sidebar-link">d</a></li></ul></li><li><a href="/sampling/hw7.html#_4-8-4" class="sidebar-link">4.8.4</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw7.html#a-2" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#b-2" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#c-2" class="sidebar-link">c</a></li></ul></li><li><a href="/sampling/hw7.html#_4-8-9" class="sidebar-link">4.8.9</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw7.html#a-3" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#b-3" class="sidebar-link">b</a></li></ul></li><li><a href="/sampling/hw7.html#_4-8-11" class="sidebar-link">4.8.11</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw7.html#a-4" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#b-4" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#d-2" class="sidebar-link">d</a></li></ul></li><li><a href="/sampling/hw7.html#_4-8-13" class="sidebar-link">4.8.13</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw7.html#a-5" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#b-5" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw7.html#c-3" class="sidebar-link">c</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="第四章补充题3"><a href="#第四章补充题3" class="header-anchor">#</a> 第四章补充题3</h2> <h3 id="_1"><a href="#_1" class="header-anchor">#</a> 1</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>agsrs <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'agsrs.csv'</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> agsrs<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span>
x <span class="token operator">=</span> agsrs<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span>
b_hat <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>n <span class="token operator">=</span> <span class="token number">300</span>
N <span class="token operator">=</span> <span class="token number">3078</span>
s_e2 <span class="token operator">=</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_hat <span class="token operator">*</span> np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b_hat<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
v_b_hat <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> s_e2 <span class="token operator">/</span> <span class="token punctuation">(</span>x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>b_hat<span class="token punctuation">)</span>
se_b_hat <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_b_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_b_hat<span class="token punctuation">)</span>
ci_b_hat <span class="token operator">=</span> <span class="token punctuation">(</span>b_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_b_hat<span class="token punctuation">,</span> b_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_b_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_b_hat<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>0.9865652371433473
0.005750472694966445
(0.9752943106612131, 0.9978361636254816)
</code></pre></div><h3 id="_2"><a href="#_2" class="header-anchor">#</a> 2</h3> <ul><li>Take 500 samples with replacement of size 100</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>bootstrap_time <span class="token operator">=</span> <span class="token number">1000</span>
bootstrap_size <span class="token operator">=</span> <span class="token number">100</span>
bootstrap_b_hat <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>bootstrap_time<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>bootstrap_time<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bootstrap_sample <span class="token operator">=</span> agsrs<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>n<span class="token operator">=</span>bootstrap_size<span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> bootstrap_sample<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span>
    x <span class="token operator">=</span> bootstrap_sample<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span>
    bootstrap_b_hat<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>bootstrap_ci95 <span class="token operator">=</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>bootstrap_b_hat<span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>percentile<span class="token punctuation">(</span>bootstrap_b_hat<span class="token punctuation">,</span> <span class="token number">97.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bootstrap_ci95<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>(0.9650709024696571, 1.008621814102108)
</code></pre></div><h2 id="_4-8-3"><a href="#_4-8-3" class="header-anchor">#</a> 4.8.3</h2> <h3 id="a"><a href="#a" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11.4</span><span class="token punctuation">,</span> <span class="token number">7.9</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10.5</span><span class="token punctuation">,</span> <span class="token number">7.9</span><span class="token punctuation">,</span> <span class="token number">7.3</span><span class="token punctuation">,</span> <span class="token number">10.2</span><span class="token punctuation">,</span> <span class="token number">11.7</span><span class="token punctuation">,</span> <span class="token number">11.3</span><span class="token punctuation">,</span> <span class="token number">5.7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10.3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9.2</span><span class="token punctuation">,</span> <span class="token number">8.5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10.7</span><span class="token punctuation">,</span> <span class="token number">9.3</span><span class="token punctuation">,</span> <span class="token number">8.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">125</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">,</span> <span class="token number">69</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">154</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">122</span><span class="token punctuation">,</span> <span class="token number">106</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">:</span> x<span class="token punctuation">,</span> <span class="token string">&quot;y&quot;</span><span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&quot;scatter plot of x and y&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;4.8.3a.svg&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="/assets/img/hw7_11_0.ebfb5fee.png" alt="png"></p> <h3 id="b"><a href="#b" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>x_u <span class="token operator">=</span> <span class="token number">10.3</span>
b_hat <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
s_e2 <span class="token operator">=</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_hat <span class="token operator">*</span> np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b_hat<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>n <span class="token operator">=</span> <span class="token number">20</span>
N <span class="token operator">=</span> <span class="token number">1132</span>
y_b_hat <span class="token operator">=</span> b_hat <span class="token operator">*</span> x_u
<span class="token keyword">print</span><span class="token punctuation">(</span>y_b_hat<span class="token punctuation">)</span>
v_y_b_hat <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> s_e2 <span class="token operator">*</span> <span class="token punctuation">(</span>x_u <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span>
se_y_b_hat <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_y_b_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_y_b_hat<span class="token punctuation">)</span>
ci_y_b_hat <span class="token operator">=</span> <span class="token punctuation">(</span>y_b_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_y_b_hat<span class="token punctuation">,</span> y_b_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_y_b_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_y_b_hat<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>117.62041467304627
3.906462190381681
(109.96374877989817, 125.27708056619437)
</code></pre></div><h3 id="c"><a href="#c" class="header-anchor">#</a> c</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>y_bar <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_bar<span class="token punctuation">)</span>
v_y_bar <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_y_bar <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_y_bar<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_y_bar<span class="token punctuation">)</span>
ci_y_bar <span class="token operator">=</span> <span class="token punctuation">(</span>y_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_y_bar<span class="token punctuation">,</span> y_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_y_bar<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_y_bar<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- extra-class"><pre><code>107.4
6.191329854807021
(95.26499348457824, 119.53500651542177)
</code></pre></div><h3 id="d"><a href="#d" class="header-anchor">#</a> d</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&quot;text.usetex&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>
fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;grey&quot;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&quot;scatter plot of x and y&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_u<span class="token punctuation">,</span> y_b_hat<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x_u<span class="token punctuation">,</span> y_bar<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x_u <span class="token operator">+</span> <span class="token number">0.1</span><span class="token punctuation">,</span> y_b_hat <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">r&quot;$\bar{y_r}=&quot;</span> <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>y_b_hat<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span> <span class="token operator">+</span> <span class="token string">r&quot;$&quot;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>text<span class="token punctuation">(</span>x_u <span class="token operator">+</span> <span class="token number">0.1</span><span class="token punctuation">,</span> y_bar<span class="token punctuation">,</span> <span class="token string">r&quot;$\bar{y}=&quot;</span> <span class="token operator">+</span> <span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>y_bar<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span> <span class="token operator">+</span> <span class="token string">r&quot;$&quot;</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;4.8.3d.svg&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="/assets/img/hw7_18_0.28037039.png" alt="png"></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>corrcoef<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>0.7816196606739746
</code></pre></div><h2 id="_4-8-4"><a href="#_4-8-4" class="header-anchor">#</a> 4.8.4</h2> <h3 id="a-2"><a href="#a-2" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>children <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">528</span><span class="token punctuation">,</span> <span class="token number">189</span><span class="token punctuation">,</span> <span class="token number">225</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;children&quot;</span><span class="token punctuation">:</span> children<span class="token punctuation">,</span> <span class="token string">&quot;y&quot;</span><span class="token punctuation">:</span> y<span class="token punctuation">}</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token number">1028</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>p_hat <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> n
<span class="token keyword">print</span><span class="token punctuation">(</span>p_hat<span class="token punctuation">)</span>
v_p_hat <span class="token operator">=</span> p_hat <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_hat<span class="token punctuation">)</span> <span class="token operator">/</span> n
se_p_hat <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_p_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_p_hat<span class="token punctuation">)</span>
ci_p_hat <span class="token operator">=</span> <span class="token punctuation">(</span>p_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_p_hat<span class="token punctuation">,</span> p_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_p_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_p_hat<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- extra-class"><pre><code>0.48638132295719844
0.015588785866183287
(0.4558273026594792, 0.5169353432549176)
</code></pre></div><h3 id="b-2"><a href="#b-2" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>y_d <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>children <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">/</span> n
se_y_d <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>children<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">*</span> y_d<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_y_d<span class="token punctuation">)</span>
ci_y_d <span class="token operator">=</span> <span class="token punctuation">(</span>y_d <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_y_d<span class="token punctuation">,</span> y_d <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_y_d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_y_d<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- extra-class"><pre><code>0.8842412451361867
0.032948157346772214
(0.8196628567365132, 0.9488196335358603)
</code></pre></div><h3 id="c-2"><a href="#c-2" class="header-anchor">#</a> c</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>t_u <span class="token operator">=</span> <span class="token number">400000</span> <span class="token operator">*</span> n <span class="token operator">/</span> <span class="token number">1500</span> <span class="token operator">*</span> y_d
se_t_u <span class="token operator">=</span> <span class="token number">400000</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">1500</span> <span class="token operator">*</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>children<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>n <span class="token operator">*</span> y_d<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1499</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_u<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_t_u<span class="token punctuation">)</span>
ci_t_u <span class="token operator">=</span> <span class="token punctuation">(</span>t_u <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t_u<span class="token punctuation">,</span> t_u <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t_u<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_t_u<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- extra-class"><pre><code>242399.99999999997
9035.200436263547
(224691.0071449234, 260108.99285507653)
</code></pre></div><h2 id="_4-8-9"><a href="#_4-8-9" class="header-anchor">#</a> 4.8.9</h2> <h3 id="a-3"><a href="#a-3" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>crimes <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;crimes.csv&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>n <span class="token operator">=</span> <span class="token number">5000</span>
N <span class="token operator">=</span> <span class="token number">7_048_107</span>
p_b <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>crimes<span class="token punctuation">[</span><span class="token string">&quot;crimetype&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;burglary&quot;</span><span class="token punctuation">)</span> <span class="token operator">/</span> n
se_p_b <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>p_b <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_b<span class="token punctuation">)</span> <span class="token operator">/</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p_b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_p_b<span class="token punctuation">)</span>
ci_p_b <span class="token operator">=</span> <span class="token punctuation">(</span>p_b <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_p_b<span class="token punctuation">,</span> p_b <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_p_b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_p_b<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- extra-class"><pre><code>0.059
0.0033322364862056236
(0.052468816487036975, 0.06553118351296303)
</code></pre></div><h3 id="b-3"><a href="#b-3" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>p_agg_d <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>crimes<span class="token punctuation">[</span><span class="token string">&quot;crimetype&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;aggasslt&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>crimes<span class="token punctuation">[</span><span class="token string">&quot;domestic&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> n
se_p_agg_d <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>p_agg_d <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_agg_d<span class="token punctuation">)</span> <span class="token operator">/</span> n<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>t_agg_d <span class="token operator">=</span> p_agg_d <span class="token operator">*</span> N
se_t_agg_d <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>p_agg_d <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_agg_d<span class="token punctuation">)</span> <span class="token operator">/</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> N
<span class="token keyword">print</span><span class="token punctuation">(</span>t_agg_d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_t_agg_d<span class="token punctuation">)</span>
ci_t_agg_d <span class="token operator">=</span> <span class="token punctuation">(</span>t_agg_d <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t_agg_d<span class="token punctuation">,</span> t_agg_d <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t_agg_d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_t_agg_d<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- extra-class"><pre><code>76119.5556
10302.4714114285
(55926.71163360015, 96312.39956639986)
</code></pre></div><h2 id="_4-8-11"><a href="#_4-8-11" class="header-anchor">#</a> 4.8.11</h2> <h3 id="a-4"><a href="#a-4" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cherry <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;cherry.csv&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>cherry<span class="token punctuation">[</span><span class="token string">&quot;diameter&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cherry<span class="token punctuation">[</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">&quot;diameter&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&quot;scatter plot of diameter and volume&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;4.8.11a.svg&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><img src="/assets/img/hw7_35_0.01a9bcfb.png" alt="png"></p> <h3 id="b-4"><a href="#b-4" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>y <span class="token operator">=</span> cherry<span class="token punctuation">[</span><span class="token string">&quot;volume&quot;</span><span class="token punctuation">]</span>
x <span class="token operator">=</span> cherry<span class="token punctuation">[</span><span class="token string">&quot;diameter&quot;</span><span class="token punctuation">]</span>
n <span class="token operator">=</span> <span class="token number">31</span>
N <span class="token operator">=</span> <span class="token number">2967</span>
b_hat <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
s_e2 <span class="token operator">=</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_hat <span class="token operator">*</span> np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b_hat<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
t_r <span class="token operator">=</span> b_hat <span class="token operator">*</span> <span class="token number">41835</span>
v_t_r <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> s_e2 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">41835</span> <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span>
se_v_t_r <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_t_r<span class="token punctuation">)</span>
ci_t_r <span class="token operator">=</span> <span class="token punctuation">(</span>t_r <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_v_t_r<span class="token punctuation">,</span> t_r <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_v_t_r<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_r<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_t_r<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language- extra-class"><pre><code>95272.15850986118
(84548.14717184479, 105996.16984787758)
</code></pre></div><h3 id="d-2"><a href="#d-2" class="header-anchor">#</a> d</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>y_bar <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_y_bar <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t_hat <span class="token operator">=</span> y_bar <span class="token operator">*</span> N
se_t_hat <span class="token operator">=</span> se_y_bar <span class="token operator">*</span> N
ci_t_hat <span class="token operator">=</span> <span class="token punctuation">(</span>t_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t_hat<span class="token punctuation">,</span> t_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci_t_hat<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- extra-class"><pre><code>89517.26129032257
(72438.47743193789, 106596.04514870724)
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>corrcoef<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>0.9671193682556305
</code></pre></div><h2 id="_4-8-13"><a href="#_4-8-13" class="header-anchor">#</a> 4.8.13</h2> <h3 id="a-5"><a href="#a-5" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>counties <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;counties.csv&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>counties<span class="token punctuation">[</span><span class="token string">&quot;physician&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">&quot;grey&quot;</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">&quot;histogram of physician&quot;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;4.8.13a.svg&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="data:image/png;base64,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abx9+zbquo6iKK7sVT47O0uvnr23txcfPnyYf7x79+5P/RAAAADwNdw6mieTSWxubs4/L8sy9vb2YjqdRqfTufZrNjY2rr19dXU1nj17duEDAAAAFs2to7ndbsfx8fGF2/74449ot9vz92qeqes6NjY2vE8zAAAAS+3W5zSXZRlbW1txeHg4j+HZec0Rny4Stru7G5ubm3F8fOw9mgEAAFh6K03TNE+9iPPz83j+/Hl8+PBh4Q/VXpQLmL1+/fqplwAAALC0btuhd3rLKQAAAPieiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABIiGYAAABI/HDXL6iqKuq6jrIsIyKi0+lERERd1zEajaIsy6jrOnq9XhRF8aCLBQAAgMd0p2iuqiqGw2EMBoOo6zq2trbi9PQ0IiK2t7fj5OQkIj4F9M7OTgyHw4dfMQAAADySO0Vzv9+fh3FZljEejyPiUyR/rizLqKrqgZYIAAAAT+PW5zTXdR1nZ2dRFEVMJpOYTqfzQ7SrqopWq3Vh+1arFZPJ5NrH+vjxY5yfn1/4AAAAgEVz62ieTCbRarXm5y0fHR3FaDSKiIjpdHrt15ydnV17+/7+fjx//nz+8fLly7uvHAAAAL6yW0fz2dlZ1HUdnU4niqKIXq8X29vbN35NFtN7e3vx4cOH+ce7d+/utGgAAAB4DLc+p7ksyyiKYn5F7Nl/J5NJFEVxZa/y7FDu66yursbq6uq9FgwAAACP5dZ7mmfnL19n9rZTl21sbNx9RQAAALAg7rSneWNjI6bTaRRFMX+v5na7fWXbuq5jY2PD+zQDAACw1O70llPD4TB2d3djfX09Tk5O5m859fl9m5ubcXx87D2aAQAAWHp3iuaiKGIwGFx7X1mWcXBwEBER3W73z68MAAAAntitz2kGAACA741oBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgIRoBgAAgMS9o3l3dzem0+n887qu4/DwMEajURweHl64DwAAAJbRvaJ5MpnE4eHhhdu2t7fj1atX0e12o9vtxs7OzoMsEAAAAJ7KvaK5rusoy/LC558ryzKqqvpzKwMAAIAndudoHo1G0e12L9xWVVW0Wq0Lt7VarZhMJn9udQAAAPCEfrjLxtPpNIqiuPb265ydnV17+8ePH+Pjx4/zz8/Pz++yDAAAAHgUd9rT/Pbt2+h0OrfePovp/f39eP78+fzj5cuXd1kGAAAAPIpbR3NVVfHzzz9fe19RFFf2Kp+dnV27VzoiYm9vLz58+DD/ePfu3e1XDAAAAI/kTodnv337dv7ruq5jf38/fvnll+h0OjEYDK5sv7Gxce3jrK6uxurq6h2XCgAAAI/r1tF8+bDsfr8f/X7/wlW0Z+q6jo2NjXRPMwAAACyDO189ezqdzt+j+eDgYH6F7OFwGLu7uzEajWIwGMRwOHzYlQIAAMAjW2mapnnqRZyfn8fz58/jw4cP8ezZs6dezo1+/fXXp15CRES8fv36qZcAAACwtG7boXfe0wwAAADfC9EMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAACdEMAAAAiR/usvFkMomqqiIi4vj4ON68eRNFUURERF3XMRqNoizLqOs6er3e/D4AAABYRneK5qqq4tWrVxERcXh4GD/99FOcnJxERMT29vb813Vdx87OTgyHwwdeLgAAADyeWx+ePZlMYn9/f/55t9uNyWQSdV1HXdcXti3Lcr5HGgAAAJbVraO53W7Hmzdv5p9Pp9OIiGi1WlFVVbRarQvbt1qtmEwm1z7Wx48f4/z8/MIHAAAALJo7XQis2+3Of11VVXQ6nSiKYh7Ql52dnV17+/7+fjx//nz+8fLly7ssAwAAAB7Fva6ePZ1OYzAYfPGc5Sym9/b24sOHD/OPd+/e3WcZAAAA8FXd6UJgMzs7OzEej+dXxy6K4spe5bOzs/Tq2aurq7G6unqfbw0AAACP5s57mg8PD+Pg4CDKsozpdBrT6TQ6nc61225sbPzpBQIAAMBTuVM0j0ajaLfb82B++/ZtFEURZVle2K6u69jY2PA+zQAAACy1Wx+eXdd1bG9vX7itKIro9XoRETEcDmN3dzc2Nzfj+PjYezQDAACw9G4dzWVZRtM0N95/cHAQERevsg0AAADL6l5XzwYAAIDvgWgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAhGgGAACAxA9PvQDu59dff33qJcTr16+fegkAAABflT3NAAAAkBDNAAAAkBDNAAAAkHBOM/e2COdVRyzOudWej4s8HwAAj8vrr6/jwaK5rusYjUZRlmXUdR29Xi+KoniohwcAAIBH92DRvL29HScnJxHxKaB3dnZiOBw+1MMDAADAo3uQc5rrur7weVmWUVXVQzw0AAAAPJkH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" alt="png"></p> <h3 id="b-5"><a href="#b-5" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>y <span class="token operator">=</span> counties<span class="token punctuation">[</span><span class="token string">&quot;physician&quot;</span><span class="token punctuation">]</span>
y_bar <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token number">100</span>
N <span class="token operator">=</span> <span class="token number">3141</span>
se_y_bar <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t_hat <span class="token operator">=</span> y_bar <span class="token operator">*</span> N
se_t_hat <span class="token operator">=</span> se_y_bar <span class="token operator">*</span> N
<span class="token keyword">print</span><span class="token punctuation">(</span>t_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_t_hat<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>933410.9700000001
491982.7871364016
</code></pre></div><h3 id="c-3"><a href="#c-3" class="header-anchor">#</a> c</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>x <span class="token operator">=</span> counties<span class="token punctuation">[</span><span class="token string">&quot;totpop&quot;</span><span class="token punctuation">]</span>
t_x <span class="token operator">=</span> <span class="token number">255_077_536</span>
x_u <span class="token operator">=</span> t_x <span class="token operator">/</span> N
b_hat <span class="token operator">=</span> y<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
s_e2 <span class="token operator">=</span> y<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_hat <span class="token operator">*</span> np<span class="token punctuation">.</span>cov<span class="token punctuation">(</span>y<span class="token punctuation">,</span> x<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> b_hat<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
t_r <span class="token operator">=</span> b_hat <span class="token operator">*</span> t_x
v_t_r <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">*</span> s_e2 <span class="token operator">*</span> <span class="token punctuation">(</span>t_x <span class="token operator">/</span> x<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span>
se_v_t_r <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_t_r<span class="token punctuation">)</span>
ci_t_r <span class="token operator">=</span> <span class="token punctuation">(</span>t_r <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_v_t_r<span class="token punctuation">,</span> t_r <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_v_t_r<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_r<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>se_v_t_r<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language- extra-class"><pre><code>639506.0283989459
87885.26514909908
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>np<span class="token punctuation">.</span>corrcoef<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>0.9771174932511311
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c81839fd.js" defer></script><script src="/assets/js/2.1ffc7243.js" defer></script><script src="/assets/js/1.21765641.js" defer></script><script src="/assets/js/24.922a5ac7.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>抽样调查第六周作业</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.c81839fd.js" as="script"><link rel="preload" href="/assets/js/2.1ffc7243.js" as="script"><link rel="preload" href="/assets/js/1.21765641.js" as="script"><link rel="preload" href="/assets/js/33.0057f8d5.js" as="script"><link rel="prefetch" href="/assets/js/10.94d9ae37.js"><link rel="prefetch" href="/assets/js/11.f71277c4.js"><link rel="prefetch" href="/assets/js/12.df91b8c5.js"><link rel="prefetch" href="/assets/js/13.ccf34248.js"><link rel="prefetch" href="/assets/js/14.cec430ee.js"><link rel="prefetch" href="/assets/js/15.075f2557.js"><link rel="prefetch" href="/assets/js/16.050b0744.js"><link rel="prefetch" href="/assets/js/17.e6b2d62e.js"><link rel="prefetch" href="/assets/js/18.e1f699c1.js"><link rel="prefetch" href="/assets/js/19.43923341.js"><link rel="prefetch" href="/assets/js/20.b20e711d.js"><link rel="prefetch" href="/assets/js/21.8dd3e2d2.js"><link rel="prefetch" href="/assets/js/22.bfe29ee7.js"><link rel="prefetch" href="/assets/js/23.d6610626.js"><link rel="prefetch" href="/assets/js/24.922a5ac7.js"><link rel="prefetch" href="/assets/js/25.082050c9.js"><link rel="prefetch" href="/assets/js/26.64d32bef.js"><link rel="prefetch" href="/assets/js/27.429314cf.js"><link rel="prefetch" href="/assets/js/28.6d085cc4.js"><link rel="prefetch" href="/assets/js/29.03a256fd.js"><link rel="prefetch" href="/assets/js/3.689860d5.js"><link rel="prefetch" href="/assets/js/30.1af4f8c4.js"><link rel="prefetch" href="/assets/js/31.5eec4937.js"><link rel="prefetch" href="/assets/js/32.b31e0c94.js"><link rel="prefetch" href="/assets/js/34.1c144145.js"><link rel="prefetch" href="/assets/js/35.997e4046.js"><link rel="prefetch" href="/assets/js/36.73c2dac3.js"><link rel="prefetch" href="/assets/js/37.0efd73ec.js"><link rel="prefetch" href="/assets/js/38.d3b0fd9d.js"><link rel="prefetch" href="/assets/js/39.1f488157.js"><link rel="prefetch" href="/assets/js/4.8c775bf3.js"><link rel="prefetch" href="/assets/js/40.3f735ee0.js"><link rel="prefetch" href="/assets/js/41.0b3072ca.js"><link rel="prefetch" href="/assets/js/42.f2deac56.js"><link rel="prefetch" href="/assets/js/43.2925ac95.js"><link rel="prefetch" href="/assets/js/44.15b774a6.js"><link rel="prefetch" href="/assets/js/45.4a73b893.js"><link rel="prefetch" href="/assets/js/46.ff126056.js"><link rel="prefetch" href="/assets/js/47.a8af33bb.js"><link rel="prefetch" href="/assets/js/48.fd9bfbfb.js"><link rel="prefetch" href="/assets/js/49.d1bb8a6b.js"><link rel="prefetch" href="/assets/js/5.4038169b.js"><link rel="prefetch" href="/assets/js/50.261e0b1b.js"><link rel="prefetch" href="/assets/js/51.ad5e908a.js"><link rel="prefetch" href="/assets/js/52.30dae559.js"><link rel="prefetch" href="/assets/js/53.5928da48.js"><link rel="prefetch" href="/assets/js/54.b392dbf9.js"><link rel="prefetch" href="/assets/js/55.02dbfb4e.js"><link rel="prefetch" href="/assets/js/6.bdb8c543.js"><link rel="prefetch" href="/assets/js/7.7ea37c1e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.be90ab07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>抽样调查第六周作业</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sampling/hw6.html#_3-8-6" class="sidebar-link">3.8.6</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw6.html#a" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw6.html#b" class="sidebar-link">b</a></li></ul></li><li><a href="/sampling/hw6.html#_3-8-8" class="sidebar-link">3.8.8</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sampling/hw6.html#_3-8-25" class="sidebar-link">3.8.25</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sampling/hw6.html#_3-8-27" class="sidebar-link">3.8.27</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sampling/hw6.html#_3-8-50" class="sidebar-link">3.8.50</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw6.html#a-2" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw6.html#b-2" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw6.html#c" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw6.html#d" class="sidebar-link">d</a></li><li class="sidebar-sub-header"><a href="/sampling/hw6.html#e" class="sidebar-link">e</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">as</span> stats
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_3-8-6"><a href="#_3-8-6" class="header-anchor">#</a> 3.8.6</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>N <span class="token operator">=</span> <span class="token number">90_000</span>
N_h <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">35000</span><span class="token punctuation">,</span> <span class="token number">45000</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;house&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apartments&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;condominium&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="a"><a href="#a" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
n <span class="token operator">=</span> <span class="token number">900</span>
n_h <span class="token operator">=</span> N_h <span class="token operator">*</span> s <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>N_h <span class="token operator">*</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> n
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;allocation: </span><span class="token interpolation"><span class="token punctuation">{</span>n_h<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>allocation: house          504.0
apartments     324.0
condominium     72.0
dtype: float64
</code></pre></div><h3 id="b"><a href="#b" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>p_h <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.45</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.03</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;house&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;apartments&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;condominium&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
we <span class="token operator">=</span> N_h <span class="token operator">/</span> N
p_str <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>p_h <span class="token operator">*</span> we<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;p from prop: </span><span class="token interpolation"><span class="token punctuation">{</span>p_str<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
v_prop <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>we<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> p_h <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_h<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>n <span class="token operator">*</span> we<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;proportional stratified:&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;variance: </span><span class="token interpolation"><span class="token punctuation">{</span>v_prop<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
v_srs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n <span class="token operator">/</span> N<span class="token punctuation">)</span> <span class="token operator">*</span> p_str <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_str<span class="token punctuation">)</span> <span class="token operator">/</span> n
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;simple random sampling:&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;variance: </span><span class="token interpolation"><span class="token punctuation">{</span>v_srs<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language- extra-class"><pre><code>p from prop: 0.3033333333333334
proportional stratified:
variance: 0.0002125566666666667
simple random sampling:
variance: 0.00023245444444444446
</code></pre></div><h2 id="_3-8-8"><a href="#_3-8-8" class="header-anchor">#</a> 3.8.8</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_n_h_with_costs</span><span class="token punctuation">(</span>N_h<span class="token punctuation">,</span> cost<span class="token punctuation">,</span> budget<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n_h_div_n <span class="token operator">=</span> N_h <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>cost<span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>N_h <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>cost<span class="token punctuation">)</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>budget <span class="token operator">/</span> <span class="token punctuation">(</span>cost <span class="token operator">*</span> n_h_div_n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>n_h_div_n <span class="token operator">*</span> n<span class="token punctuation">)</span>
    


costs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
N_h_p <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.9</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
budget <span class="token operator">=</span> <span class="token number">150_000</span>
n_h <span class="token operator">=</span> get_n_h_with_costs<span class="token punctuation">(</span>N_h_p<span class="token punctuation">,</span> costs<span class="token punctuation">,</span> budget<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;all in person allocation: </span><span class="token interpolation"><span class="token punctuation">{</span>n_h<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language- extra-class"><pre><code>all in person allocation: [4396.  423.]
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>costs <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
n_h <span class="token operator">=</span> get_n_h_with_costs<span class="token punctuation">(</span>N_h_p<span class="token punctuation">,</span> costs<span class="token punctuation">,</span> budget<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;telephone and in person allocation: </span><span class="token interpolation"><span class="token punctuation">{</span>n_h<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>telephone and in person allocation: [8249.  458.]
</code></pre></div><h2 id="_3-8-25"><a href="#_3-8-25" class="header-anchor">#</a> 3.8.25</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>acre <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>
    np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">1054</span><span class="token punctuation">,</span> <span class="token number">1382</span><span class="token punctuation">,</span> <span class="token number">422</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">97629.8</span><span class="token punctuation">,</span> <span class="token number">300504.2</span><span class="token punctuation">,</span> <span class="token number">211315</span><span class="token punctuation">,</span> <span class="token number">662295.5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">[</span><span class="token number">7647472708</span><span class="token punctuation">,</span> <span class="token number">29618183543</span><span class="token punctuation">,</span> <span class="token number">53587487856</span><span class="token punctuation">,</span> <span class="token number">396185950266</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">,</span>
    columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;n_h&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;y_bar&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;s2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

y_u <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>acre<span class="token punctuation">[</span><span class="token string">&quot;n_h&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> acre<span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> acre<span class="token punctuation">[</span><span class="token string">&quot;y_bar&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> <span class="token number">0.1</span>
v_m <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> y_u <span class="token operator">/</span> <span class="token number">1.96</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span>
n_h_div_n <span class="token operator">=</span> acre<span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> acre<span class="token punctuation">[</span><span class="token string">&quot;s2&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>acre<span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> acre<span class="token punctuation">[</span><span class="token string">&quot;s2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">get_v</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n_h_div_n <span class="token operator">*</span> n <span class="token operator">/</span> acre<span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> acre<span class="token punctuation">[</span><span class="token string">&quot;s2&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>n_h_div_n <span class="token operator">*</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">/</span> acre<span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">bisection_n</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    n_min <span class="token operator">=</span> <span class="token number">1</span>
    n_max <span class="token operator">=</span> np<span class="token punctuation">.</span>floor<span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>acre<span class="token punctuation">[</span><span class="token string">&quot;N_h&quot;</span><span class="token punctuation">]</span> <span class="token operator">/</span> n_h_div_n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> n_max <span class="token operator">-</span> n_min <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>
        n_mid <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n_min <span class="token operator">+</span> n_max<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
        v_mid <span class="token operator">=</span> get_v<span class="token punctuation">(</span>n_mid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> v_mid <span class="token operator">&gt;</span> v_m<span class="token punctuation">:</span>
            n_min <span class="token operator">=</span> n_mid
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            n_max <span class="token operator">=</span> n_mid
    <span class="token keyword">return</span> n_min

n <span class="token operator">=</span> bisection_n<span class="token punctuation">(</span><span class="token punctuation">)</span>
n_h <span class="token operator">=</span> n_h_div_n <span class="token operator">*</span> n
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;required sample obs.: </span><span class="token interpolation"><span class="token punctuation">{</span>n<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;allocation: </span><span class="token interpolation"><span class="token punctuation">{</span>n_h<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><div class="language- extra-class"><pre><code>required sample obs.: 666.0
allocation: 0      4.087231
1     75.838121
2    179.911934
3    406.162714
dtype: float64
</code></pre></div><h2 id="_3-8-27"><a href="#_3-8-27" class="header-anchor">#</a> 3.8.27</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>n <span class="token operator">=</span> <span class="token number">1100</span>
N <span class="token operator">=</span> <span class="token number">15769</span>
N_h <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">5803</span><span class="token punctuation">,</span> <span class="token number">9966</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;female&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;male&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
we_prop <span class="token operator">=</span> N_h <span class="token operator">/</span> N
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;proportional allocation: </span><span class="token interpolation"><span class="token punctuation">{</span>we_prop <span class="token operator">*</span> n<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token operator">/</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
n_h <span class="token operator">=</span> N_h <span class="token operator">*</span> s <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>N_h <span class="token operator">*</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> n
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;Neyman allocation: </span><span class="token interpolation"><span class="token punctuation">{</span>n_h<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- extra-class"><pre><code>proportional allocation: female    404.800558
male      695.199442
dtype: float64
Neyman allocation: female    617.758637
male      482.241363
dtype: float64
</code></pre></div><h2 id="_3-8-50"><a href="#_3-8-50" class="header-anchor">#</a> 3.8.50</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>baseball <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./baseball.csv&quot;</span><span class="token punctuation">)</span>
baseball<span class="token punctuation">[</span><span class="token string">&quot;logsal&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>baseball<span class="token punctuation">[</span><span class="token string">&quot;salary&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
baseball<span class="token punctuation">[</span><span class="token string">&quot;is_pitcher&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> baseball<span class="token punctuation">[</span><span class="token string">&quot;pos&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;P&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="a-2"><a href="#a-2" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>stratified_baseball <span class="token operator">=</span> baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">,</span> group_keys<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">150</span> <span class="token operator">/</span> baseball<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="b-2"><a href="#b-2" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_mean_and_ci</span><span class="token punctuation">(</span>sample_df<span class="token punctuation">,</span> strata<span class="token punctuation">,</span> target<span class="token punctuation">,</span> N_h<span class="token punctuation">,</span> we<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n_h <span class="token operator">=</span> sample_df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>strata<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>
    y_bar <span class="token operator">=</span> sample_df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>strata<span class="token punctuation">)</span><span class="token punctuation">[</span>target<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    s2 <span class="token operator">=</span> sample_df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>strata<span class="token punctuation">)</span><span class="token punctuation">[</span>target<span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
    y_str <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>we <span class="token operator">*</span> y_bar<span class="token punctuation">)</span>
    v_m <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>we<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> s2 <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> n_h <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">/</span> N_h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ci <span class="token operator">=</span> stats<span class="token punctuation">.</span>norm<span class="token punctuation">.</span>interval<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> loc<span class="token operator">=</span>y_str<span class="token punctuation">,</span> scale<span class="token operator">=</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_m<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> y_str<span class="token punctuation">,</span> ci
    
p_pitcher<span class="token punctuation">,</span> p_pitcher_ci <span class="token operator">=</span> get_mean_and_ci<span class="token punctuation">(</span>stratified_baseball<span class="token punctuation">,</span> <span class="token string">&quot;team&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;is_pitcher&quot;</span><span class="token punctuation">,</span> baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> baseball<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;proportion of pitchers: </span><span class="token interpolation"><span class="token punctuation">{</span>p_pitcher<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;95% CI: </span><span class="token interpolation"><span class="token punctuation">{</span>p_pitcher_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language- extra-class"><pre><code>proportion of pitchers: 0.3959849435382685
95% CI: (0.3298682908550369, 0.46210159622150015)
</code></pre></div><h3 id="c"><a href="#c" class="header-anchor">#</a> c</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>logsal<span class="token punctuation">,</span> logsal_ci <span class="token operator">=</span> get_mean_and_ci<span class="token punctuation">(</span>stratified_baseball<span class="token punctuation">,</span> <span class="token string">&quot;team&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;logsal&quot;</span><span class="token punctuation">,</span> baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> baseball<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;mean log salary: </span><span class="token interpolation"><span class="token punctuation">{</span>logsal<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;95% CI: </span><span class="token interpolation"><span class="token punctuation">{</span>logsal_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>mean log salary: 13.84882748784042
95% CI: (13.675176032005984, 14.022478943674857)
</code></pre></div><h3 id="d"><a href="#d" class="header-anchor">#</a> d</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>logsal_sample_var <span class="token operator">=</span> stratified_baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;logsal&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>logsal_sample_var<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>(array([4., 4., 4., 3., 4., 6., 3., 0., 1., 1.]),
 array([0.02639362, 0.39229791, 0.7582022 , 1.12410649, 1.49001078,
        1.85591508, 2.22181937, 2.58772366, 2.95362795, 3.31953225,
        3.68543654]),
 &lt;BarContainer object of 10 artists&gt;)
</code></pre></div><p><img src="data:image/png;base64,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H3zffZYtWxannXZalEqlOO6442LBggVVnzNTpWtetmzZe851XV1dbN26tWcGTtDS0hJnnnlmDB48OIYNGxZTp06NjRs3vu9+tf687s66+8Nze968eTF+/PiOPwQ1ceLEePTRR/e6T62f60rX3B/O8+76dFhUeon2p556Kq688sq49tprY926dTF16tSYOnVqPPPMMz08efd157L0DQ0N8cYbb3TcXnnllR6cOMfOnTvj5JNPjrlz536g7Tdv3hxTpkyJc889N9avXx/Tp0+PL3zhC7FkyZIqT5qn0jW/Y+PGjZ3O97Bhw6o0Yb7ly5dHc3NzrFy5MpYuXRpvv/12XHTRRbFz584u9+kPz+vurDui9p/bI0eOjDlz5sSaNWti9erVcd5558Xll18ezz777B637w/nutI1R9T+eX6Pog+bMGFC0dzc3HF/165dxYgRI4qWlpY9bv/pT3+6mDJlSqfHzjrrrOLLX/5yVefMVOma77nnnqKxsbGHpusZEVEsWrRor9t885vfLMaOHdvpsSuuuKK4+OKLqzhZ9XyQNf/ud78rIqJ46623emSmnrBt27YiIorly5d3uU1/eF7v7oOsuz8+t4uiKA477LDiJz/5yR6/1h/PdVHsfc398Tz32Vcs3rlE+wUXXNDx2Ptdov3pp5/utH1ExMUXX9zl9n1Nd9YcEbFjx44YNWpUNDU1vW8Z9xe1fq73xSmnnBLDhw+PCy+8MJ588sneHmeftLa2RkTEkCFDutymP57rD7LuiP713N61a1csXLgwdu7c2eUlIPrbuf4ga47oX+c5og+/FbK3S7R39Z7y1q1bK9q+r+nOmkePHh133313PPTQQ/Hzn/882tvb4+yzz47XXnutJ0buNV2d67a2tvjPf/7TS1NV1/Dhw+POO++MBx54IB544IFoamqKyZMnx9q1a3t7tG5pb2+P6dOnx6RJk2LcuHFdblfrz+vdfdB195fn9oYNG+KQQw6JUqkUX/nKV2LRokUxZsyYPW7bX851JWvuL+f53ap+2XSqa+LEiZ1K+Oyzz44TTzwx5s+fHzfffHMvTka20aNHx+jRozvun3322fHiiy/GbbfdFj/72c96cbLuaW5ujmeeeSZ+//vf9/YoPeqDrru/PLdHjx4d69evj9bW1vjVr34V06ZNi+XLl3f5g7Y/qGTN/eU8v1ufDYvuXKL9yCOPrGj7vqY7a97dgQceGKeeemps2rSpGiP2GV2d64aGhjjooIN6aaqeN2HChJr8wXz99dfHww8/HCtWrIiRI0fuddtaf16/WyXr3l2tPrfr6+vjuOOOi4iI008/PVatWhV33HFHzJ8//z3b9pdzXcmad1er5/nd+uxbId25RPvEiRM7bR8RsXTp0pq5pHvGZel37doVGzZsiOHDh1drzD6h1s91lvXr19fUuS6KIq6//vpYtGhRPPHEE3HMMce87z794Vx3Z9276y/P7fb29iiXy3v8Wn8413uytzXvrl+c597+9OjeLFy4sCiVSsWCBQuK5557rvjSl75UHHroocXWrVuLoiiKq6++upg5c2bH9k8++WQxcODA4gc/+EHx/PPPFzfddFNx4IEHFhs2bOitJVSs0jXPnj27WLJkSfHiiy8Wa9asKT7zmc8UgwYNKp599tneWkK3bN++vVi3bl2xbt26IiKKW2+9tVi3bl3xyiuvFEVRFDNnziyuvvrqju1feuml4uCDDy6+8Y1vFM8//3wxd+7cYsCAAcXixYt7awkVq3TNt912W/Hggw8WL7zwQrFhw4bixhtvLA444IDiscce660lVOy6664rGhsbi2XLlhVvvPFGx+3f//53xzb98XndnXX3h+f2zJkzi+XLlxebN28u/vSnPxUzZ84s6urqit/+9rdFUfTPc13pmvvDed5dnw6LoiiKH/3oR8VRRx1V1NfXFxMmTChWrlzZ8bVzzjmnmDZtWqftf/nLXxbHH398UV9fX4wdO7Z45JFHenjifVfJmqdPn96x7RFHHFF84hOfKNauXdsLU++bd36VcvfbO2udNm1acc4557xnn1NOOaWor68vjj322OKee+7p8bn3RaVrvuWWW4qPfOQjxaBBg4ohQ4YUkydPLp544oneGb6b9rTeiOh07vrj87o76+4Pz+3Pf/7zxahRo4r6+vpi6NChxfnnn9/xA7Yo+ue5rnTN/eE8785l0wGANH32MxYAQO0RFgBAGmEBAKQRFgBAGmEBAKQRFgBAGmEBAKQRFgBAGmEBAKQRFgBAGmEBAKQRFgBAmv8DCSHk4C0DCPMAAAAASUVORK5CYII=" alt="png"></p> <h3 id="e"><a href="#e" class="header-anchor">#</a> e</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>we <span class="token operator">=</span> baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> baseball<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
n_h_div_n <span class="token operator">=</span> we <span class="token operator">*</span> logsal_sample_var <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>we <span class="token operator">*</span> logsal_sample_var<span class="token punctuation">)</span>
n_h <span class="token operator">=</span> n_h_div_n <span class="token operator">*</span> <span class="token number">150</span>
n_h <span class="token operator">=</span> n_h<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
diff <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>stratified_baseball<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;team&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> n_h<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;diff: </span><span class="token interpolation"><span class="token punctuation">{</span>diff<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- extra-class"><pre><code>diff: 279.0
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c81839fd.js" defer></script><script src="/assets/js/2.1ffc7243.js" defer></script><script src="/assets/js/1.21765641.js" defer></script><script src="/assets/js/33.0057f8d5.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>抽样调查第五周作业</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.c81839fd.js" as="script"><link rel="preload" href="/assets/js/2.1ffc7243.js" as="script"><link rel="preload" href="/assets/js/1.21765641.js" as="script"><link rel="preload" href="/assets/js/52.30dae559.js" as="script"><link rel="prefetch" href="/assets/js/10.94d9ae37.js"><link rel="prefetch" href="/assets/js/11.f71277c4.js"><link rel="prefetch" href="/assets/js/12.df91b8c5.js"><link rel="prefetch" href="/assets/js/13.ccf34248.js"><link rel="prefetch" href="/assets/js/14.cec430ee.js"><link rel="prefetch" href="/assets/js/15.075f2557.js"><link rel="prefetch" href="/assets/js/16.050b0744.js"><link rel="prefetch" href="/assets/js/17.e6b2d62e.js"><link rel="prefetch" href="/assets/js/18.e1f699c1.js"><link rel="prefetch" href="/assets/js/19.43923341.js"><link rel="prefetch" href="/assets/js/20.b20e711d.js"><link rel="prefetch" href="/assets/js/21.8dd3e2d2.js"><link rel="prefetch" href="/assets/js/22.bfe29ee7.js"><link rel="prefetch" href="/assets/js/23.d6610626.js"><link rel="prefetch" href="/assets/js/24.922a5ac7.js"><link rel="prefetch" href="/assets/js/25.082050c9.js"><link rel="prefetch" href="/assets/js/26.64d32bef.js"><link rel="prefetch" href="/assets/js/27.429314cf.js"><link rel="prefetch" href="/assets/js/28.6d085cc4.js"><link rel="prefetch" href="/assets/js/29.03a256fd.js"><link rel="prefetch" href="/assets/js/3.689860d5.js"><link rel="prefetch" href="/assets/js/30.1af4f8c4.js"><link rel="prefetch" href="/assets/js/31.5eec4937.js"><link rel="prefetch" href="/assets/js/32.b31e0c94.js"><link rel="prefetch" href="/assets/js/33.0057f8d5.js"><link rel="prefetch" href="/assets/js/34.1c144145.js"><link rel="prefetch" href="/assets/js/35.997e4046.js"><link rel="prefetch" href="/assets/js/36.73c2dac3.js"><link rel="prefetch" href="/assets/js/37.0efd73ec.js"><link rel="prefetch" href="/assets/js/38.d3b0fd9d.js"><link rel="prefetch" href="/assets/js/39.1f488157.js"><link rel="prefetch" href="/assets/js/4.8c775bf3.js"><link rel="prefetch" href="/assets/js/40.3f735ee0.js"><link rel="prefetch" href="/assets/js/41.0b3072ca.js"><link rel="prefetch" href="/assets/js/42.f2deac56.js"><link rel="prefetch" href="/assets/js/43.2925ac95.js"><link rel="prefetch" href="/assets/js/44.15b774a6.js"><link rel="prefetch" href="/assets/js/45.4a73b893.js"><link rel="prefetch" href="/assets/js/46.ff126056.js"><link rel="prefetch" href="/assets/js/47.a8af33bb.js"><link rel="prefetch" href="/assets/js/48.fd9bfbfb.js"><link rel="prefetch" href="/assets/js/49.d1bb8a6b.js"><link rel="prefetch" href="/assets/js/5.4038169b.js"><link rel="prefetch" href="/assets/js/50.261e0b1b.js"><link rel="prefetch" href="/assets/js/51.ad5e908a.js"><link rel="prefetch" href="/assets/js/53.5928da48.js"><link rel="prefetch" href="/assets/js/54.b392dbf9.js"><link rel="prefetch" href="/assets/js/55.02dbfb4e.js"><link rel="prefetch" href="/assets/js/6.bdb8c543.js"><link rel="prefetch" href="/assets/js/7.7ea37c1e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.be90ab07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>抽样调查第五周作业</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sampling/hw5.html#_3-8-3" class="sidebar-link">3.8.3</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#a" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#b" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#c" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#d" class="sidebar-link">d</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#e" class="sidebar-link">e</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#f" class="sidebar-link">f</a></li></ul></li><li><a href="/sampling/hw5.html#_3-8-7" class="sidebar-link">3.8.7</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#a-2" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#b-2" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#c-2" class="sidebar-link">c</a></li></ul></li><li><a href="/sampling/hw5.html#_3-8-12" class="sidebar-link">3.8.12</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#a-3" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#c-3" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#d-2" class="sidebar-link">d</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#e-2" class="sidebar-link">e</a></li></ul></li><li><a href="/sampling/hw5.html#_3-8-16" class="sidebar-link">3.8.16</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#a-4" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#b-3" class="sidebar-link">b</a></li></ul></li><li><a href="/sampling/hw5.html#_3-8-19" class="sidebar-link">3.8.19</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#b-4" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#c-4" class="sidebar-link">c</a></li></ul></li><li><a href="/sampling/hw5.html#_3-8-24" class="sidebar-link">3.8.24</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#b-5" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#c-5" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#d-3" class="sidebar-link">d</a></li></ul></li><li><a href="/sampling/hw5.html#_3-8-49" class="sidebar-link">3.8.49</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw5.html#a-5" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#b-6" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#c-6" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw5.html#d-4" class="sidebar-link">d</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_3-8-3"><a href="#_3-8-3" class="header-anchor">#</a> 3.8.3</h2> <h3 id="a"><a href="#a" class="header-anchor">#</a> a</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>score <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;population mean:&quot;</span><span class="token punctuation">,</span> mean<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;population mean: 71.8333333333333&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;population var:&quot;</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;population var: 86.1666666666667&quot;
</code></pre></div><h3 id="b"><a href="#b" class="header-anchor">#</a> b</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;nummber of SRS's of size 4:&quot;</span><span class="token punctuation">,</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token number">5</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;nummber of SRS's of size 4: 15&quot;
</code></pre></div><h3 id="c"><a href="#c" class="header-anchor">#</a> c</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment"># list the possible SRS's of size 4</span>
n <span class="token operator">&lt;-</span> <span class="token number">4</span>
srs_score <span class="token operator">&lt;-</span> combn<span class="token punctuation">(</span>score<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>
write.csv<span class="token punctuation">(</span>srs_score<span class="token punctuation">,</span> <span class="token string">&quot;./sampling/srs_score.csv&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># calculate the mean of each SRS</span>
srs_mean <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>srs_score<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> mean<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;SRS's mean:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;SRS's mean:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>srs_mean<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>##  [1] 69.50 69.25 66.50 72.50 69.75 69.50 75.25 72.50 72.25 75.50 73.50 70.75 70.50 73.75 76.50
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment"># calculate the variance of the SRS's mean</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;variance of SRS's mean:&quot;</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token operator">/</span> n <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;variance of SRS's mean: 7.18055555555556&quot;
</code></pre></div><h3 id="d"><a href="#d" class="header-anchor">#</a> d</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>&quot;number of stratified random samples of size <span class="token number">4</span>
<span class="token keyword">in</span> which <span class="token number">2</span> students are
selected from each stratum<span class="token operator">:</span>&quot;<span class="token punctuation">,</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;number of stratified random samples of size 4\nin which 2 students are\nselected from each stratum: 9&quot;
</code></pre></div><h3 id="e"><a href="#e" class="header-anchor">#</a> e</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment"># list the possible stratified random samples</span>
strat_combined_1 <span class="token operator">&lt;-</span> combn<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">66</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
strat_combined_2 <span class="token operator">&lt;-</span> combn<span class="token punctuation">(</span>c<span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
stratified_score <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stratified_score <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>
            stratified_score<span class="token punctuation">,</span>
            c<span class="token punctuation">(</span>
                strat_combined_1<span class="token punctuation">[</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span>
                strat_combined_2<span class="token punctuation">[</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;stratified random samples:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;stratified random samples:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>stratified_score<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
## [1,]   66   66   66   66   66   66   59   59   59
## [2,]   59   59   59   70   70   70   70   70   70
## [3,]   83   83   82   83   83   82   83   83   82
## [4,]   82   71   71   82   71   71   82   71   71
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>write.csv<span class="token punctuation">(</span>stratified_score<span class="token punctuation">,</span> <span class="token string">&quot;./sampling/stratified_score.csv&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># srs_score that does not occur in stratified_score</span>
not_stratified_srs_score <span class="token operator">&lt;-</span> matrix<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>any<span class="token punctuation">(</span>apply<span class="token punctuation">(</span>
        stratified_score<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token keyword">function</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> all<span class="token punctuation">(</span>x <span class="token operator">==</span> srs_score<span class="token punctuation">[</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        not_stratified_srs_score <span class="token operator">&lt;-</span>
            cbind<span class="token punctuation">(</span>not_stratified_srs_score<span class="token punctuation">,</span> srs_score<span class="token punctuation">[</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;srs_score that does not occur in stratified_score:&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;srs_score that does not occur in stratified_score:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>not_stratified_srs_score<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]   66   66   66   66   59   70
## [2,]   59   59   59   83   83   83
## [3,]   70   70   70   82   82   82
## [4,]   83   82   71   71   71   71
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>write.csv<span class="token punctuation">(</span>
    not_stratified_srs_score<span class="token punctuation">,</span>
    <span class="token string">&quot;./sampling/not_stratified_srs_score.csv&quot;</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="f"><a href="#f" class="header-anchor">#</a> f</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment"># mean of stratified samples</span>
stratified_mean <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>stratified_score<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> mean<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;mean of stratified samples:&quot;</span><span class="token punctuation">,</span> mean<span class="token punctuation">(</span>stratified_mean<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;mean of stratified samples: 71.8333333333333&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment"># variance of stratified samples</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;variance of stratified samples:&quot;</span><span class="token punctuation">,</span>
    var<span class="token punctuation">(</span>stratified_mean<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">/</span> <span class="token number">9</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;variance of stratified samples: 3.13888888888889&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment"># compare with the variance of SRS's mean</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;variance of SRS's mean is &quot;</span><span class="token punctuation">,</span>
    var<span class="token punctuation">(</span>score<span class="token punctuation">)</span> <span class="token operator">/</span> n <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n <span class="token operator">/</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">&quot; and variance of stratified samples is &quot;</span><span class="token punctuation">,</span>
    var<span class="token punctuation">(</span>stratified_mean<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">/</span> <span class="token number">9</span><span class="token punctuation">,</span>
    <span class="token string">&quot; This shows that the variance of stratified samples is&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;smaller than the variance of SRS's mean.&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;variance of SRS's mean is  7.18055555555556  and variance of stratified samples is  3.13888888888889  This shows that the variance of stratified samples is smaller than the variance of SRS's mean.&quot;
</code></pre></div><h2 id="_3-8-7"><a href="#_3-8-7" class="header-anchor">#</a> 3.8.7</h2> <h3 id="a-2"><a href="#a-2" class="header-anchor">#</a> a</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code><span class="token comment">#' @param n number of samples</span>
<span class="token comment">#' @param s2 sample variance</span>
<span class="token comment">#' @param n_pop population size</span>
get_se <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n_pop <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n_pop <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>s2 <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n <span class="token operator">/</span> n_pop<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>s2 <span class="token operator">/</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
nrp <span class="token operator">&lt;-</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">8</span>
bio <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
physical <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
social <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
humanities <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
subject <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">&quot;bio&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;physical&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;social&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;humanities&quot;</span><span class="token punctuation">)</span>
data <span class="token operator">&lt;-</span> data.frame<span class="token punctuation">(</span>nrp<span class="token punctuation">,</span> bio<span class="token punctuation">,</span> physical<span class="token punctuation">,</span> social<span class="token punctuation">,</span> humanities<span class="token punctuation">)</span>
subject_total <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
subject_sample_size <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">,</span> subject<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> subject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    subject_total <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>subject_total<span class="token punctuation">,</span> sum<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">*</span> data<span class="token operator">$</span>nrp<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
subject_mean <span class="token operator">&lt;-</span> subject_total <span class="token operator">/</span> subject_sample_size
subject_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">)</span>
subject_se <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
subject_var <span class="token operator">=</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> subject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    temp <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token keyword">in</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        temp <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> rep<span class="token punctuation">(</span>j<span class="token punctuation">,</span> data<span class="token punctuation">[</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    print<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
    subject_var <span class="token operator">=</span> c<span class="token punctuation">(</span>subject_var<span class="token punctuation">,</span> var<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    print<span class="token punctuation">(</span>var<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    subject_se <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>
        subject_se<span class="token punctuation">,</span>
        get_se<span class="token punctuation">(</span>
            n <span class="token operator">=</span> sum<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            s2 <span class="token operator">=</span> var<span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">,</span>
            n_pop <span class="token operator">=</span> sum<span class="token punctuation">(</span>subject_pop<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><div class="language- extra-class"><pre><code>## [1] 0 1 1 3 5 5 7
## [1] 6.809524
##  [1] 0 0 0 0 0 0 0 0 0 0 1 1 3 4 4 5 6 8 8
## [1] 8.210526
##  [1] 0 0 0 0 0 0 0 0 0 2 4 4 6
## [1] 4.358974
##  [1] 0 0 0 0 0 0 0 0 1 1 3
## [1] 0.8727273
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;mean of each subject:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;mean of each subject:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>subject_mean<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>##        bio   physical     social humanities 
##  3.1428571  2.1052632  1.2307692  0.4545455
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;estimated total nrp:&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span>subject_mean <span class="token operator">*</span> subject_pop<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;estimated total nrp: 1321.18902150481&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;standard error of each subject:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;standard error of each subject:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>subject_se<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] 0.9820138 0.6495836 0.5743729 0.2797452
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;estimated total nrp standard error:&quot;</span><span class="token punctuation">,</span>
    sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>subject_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> subject_se<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;estimated total nrp standard error: 261.911666550702&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>W <span class="token operator">=</span> subject_pop <span class="token operator">/</span> <span class="token number">807</span>
print<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>subject_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>subject_sample_size<span class="token operator">/</span> W <span class="token operator">/</span> <span class="token number">807</span><span class="token punctuation">)</span><span class="token operator">*</span>subject_var<span class="token operator">/</span>subject_sample_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>## [1] 65610.78
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>subject_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>subject_sample_size<span class="token operator">/</span> subject_pop<span class="token punctuation">)</span><span class="token operator">*</span>subject_var<span class="token operator">/</span>subject_sample_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] 65610.78
</code></pre></div><h3 id="b-2"><a href="#b-2" class="header-anchor">#</a> b</h3> <ul><li>In 2.13.6, we get total nrp=1.78*807=1430.26,</li> <li>se = 0.36*807 = 287.32;</li> <li>In 3.8.7, we get total nrp=1.78*807=1321.19,</li> <li>se = 47.04;</li> <li>smaller se means more accurate estimation.</li> <li>smaller nrp is what we have observed.</li></ul> <h3 id="c-2"><a href="#c-2" class="header-anchor">#</a> c</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>subject_prop <span class="token operator">&lt;-</span> data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> subject<span class="token punctuation">]</span> <span class="token operator">/</span> subject_sample_size
pop_prop <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>subject_prop <span class="token operator">*</span> subject_pop<span class="token punctuation">)</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>subject_pop<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;population proportion:&quot;</span><span class="token punctuation">,</span> pop_prop<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;population proportion: 0.566808721181642&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>prop_se <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    prop_se <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>
        prop_se<span class="token punctuation">,</span>
        sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> subject_sample_size<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> subject_pop<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token operator">*</span> subject_prop<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> subject_prop<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token operator">/</span> <span class="token punctuation">(</span>subject_sample_size<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;standard error of each subject:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;standard error of each subject:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>prop_se<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## $bio
## [1] 0.1378681
## 
## $physical
## [1] 0.1140242
## 
## $social
## [1] 0.1291821
## 
## $humanities
## [1] 0.1364147
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;estimated total standard error:&quot;</span><span class="token punctuation">,</span>
    sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span><span class="token punctuation">(</span>subject_pop <span class="token operator">/</span> sum<span class="token punctuation">(</span>subject_pop<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> unlist<span class="token punctuation">(</span>prop_se<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;estimated total standard error: 0.0658344870083918&quot;
</code></pre></div><h2 id="_3-8-12"><a href="#_3-8-12" class="header-anchor">#</a> 3.8.12</h2> <h3 id="a-3"><a href="#a-3" class="header-anchor">#</a> a</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>health_journal <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">&quot;./sampling/healthjournals.csv&quot;</span><span class="token punctuation">)</span>
health_journal<span class="token punctuation">[</span>health_journal <span class="token operator">==</span> <span class="token string">&quot;Yes&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">1</span>
health_journal<span class="token punctuation">[</span>health_journal <span class="token operator">==</span> <span class="token string">&quot;No&quot;</span><span class="token punctuation">]</span> <span class="token operator">&lt;-</span> <span class="token number">0</span>
journal_name <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">&quot;AJPH&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;AJPM&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PM&quot;</span><span class="token punctuation">)</span>
journal_sample <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span>
journal_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">)</span>
weight <span class="token operator">&lt;-</span> journal_pop <span class="token operator">/</span> journal_sample
print<span class="token punctuation">(</span>weight<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- extra-class"><pre><code>## [1] 2.800000 2.710526 2.733333
</code></pre></div><h3 id="c-3"><a href="#c-3" class="header-anchor">#</a> c</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>journal_logi <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">&quot;RandomSel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;RandomAssn&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ConfInt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HypTest&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Asterisks&quot;</span><span class="token punctuation">)</span>
health_journal<span class="token punctuation">[</span><span class="token punctuation">,</span> journal_logi<span class="token punctuation">]</span> <span class="token operator">&lt;-</span>
    apply<span class="token punctuation">(</span>health_journal<span class="token punctuation">[</span><span class="token punctuation">,</span> journal_logi<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> as.numeric<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;sampling weight for each stratum:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;sampling weight for each stratum:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>weight<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] 2.800000 2.710526 2.733333
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>health_journal<span class="token operator">$</span>ci_hyp_both <span class="token operator">&lt;-</span>
    <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>ConfInt <span class="token operator">+</span> health_journal<span class="token operator">$</span>HypTest<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
health_journal<span class="token operator">$</span>ci_hyp_neither <span class="token operator">&lt;-</span>
    <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>ConfInt <span class="token operator">+</span> health_journal<span class="token operator">$</span>HypTest<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
health_journal<span class="token operator">$</span>ci_only <span class="token operator">&lt;-</span>
    <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>ConfInt <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>HypTest <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
health_journal<span class="token operator">$</span>hyp_only <span class="token operator">&lt;-</span>
    <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>ConfInt <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>HypTest <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
health_journal<span class="token operator">$</span>sel_assn_both <span class="token operator">&lt;-</span>
    <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>RandomSel <span class="token operator">+</span> health_journal<span class="token operator">$</span>RandomAssn<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span>
health_journal<span class="token operator">$</span>sel_assn_neither <span class="token operator">&lt;-</span>
    <span class="token punctuation">(</span>health_journal<span class="token operator">$</span>RandomSel <span class="token operator">+</span> health_journal<span class="token operator">$</span>RandomAssn<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>
ajph <span class="token operator">&lt;-</span> health_journal<span class="token punctuation">[</span>health_journal<span class="token operator">$</span>Journal <span class="token operator">==</span> <span class="token string">&quot;AJPH&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
ajpm <span class="token operator">&lt;-</span> health_journal<span class="token punctuation">[</span>health_journal<span class="token operator">$</span>Journal <span class="token operator">==</span> <span class="token string">&quot;AJPM&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
pm <span class="token operator">&lt;-</span> health_journal<span class="token punctuation">[</span>health_journal<span class="token operator">$</span>Journal <span class="token operator">==</span> <span class="token string">&quot;PM&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>

ajph_mean <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>ajph<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> mean<span class="token punctuation">)</span>
ajpm_mean <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>ajpm<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> mean<span class="token punctuation">)</span>
pm_mean <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>pm<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> mean<span class="token punctuation">)</span>

get_se_p <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> n<span class="token punctuation">,</span> n_pop <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> p <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n_pop <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>p <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        return<span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n <span class="token operator">/</span> n_pop<span class="token punctuation">)</span> <span class="token operator">*</span> p <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
mean_matrix <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>ajph_mean<span class="token punctuation">,</span> ajpm_mean<span class="token punctuation">,</span> pm_mean<span class="token punctuation">)</span>

mean_weight_matrix <span class="token operator">&lt;-</span> <span class="token number">1</span> <span class="token operator">/</span> weight <span class="token operator">*</span> mean_matrix
percentage <span class="token operator">&lt;-</span> apply<span class="token punctuation">(</span>mean_weight_matrix<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>

se_matrix <span class="token operator">&lt;-</span> cbind<span class="token punctuation">(</span>
    get_se_p<span class="token punctuation">(</span>ajph_mean<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>
    get_se_p<span class="token punctuation">(</span>ajpm_mean<span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">,</span>
    get_se_p<span class="token punctuation">(</span>pm_mean<span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><div class="language- extra-class"><pre><code>## Warning in p == 0 || p == 1: 'length(x) = 11 &gt; 1' in coercion to 'logical(1)'

## Warning in p == 0 || p == 1: 'length(x) = 11 &gt; 1' in coercion to 'logical(1)'

## Warning in p == 0 || p == 1: 'length(x) = 11 &gt; 1' in coercion to 'logical(1)'

## Warning in p == 0 || p == 1: 'length(x) = 11 &gt; 1' in coercion to 'logical(1)'

## Warning in p == 0 || p == 1: 'length(x) = 11 &gt; 1' in coercion to 'logical(1)'

## Warning in p == 0 || p == 1: 'length(x) = 11 &gt; 1' in coercion to 'logical(1)'
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>se_weight_matrix <span class="token operator">&lt;-</span> <span class="token number">1</span> <span class="token operator">/</span> weight<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_matrix
percentage_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>apply<span class="token punctuation">(</span>se_weight_matrix<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">)</span>

needed_percentage <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token string">&quot;ci_only&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hyp_only&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ci_hyp_both&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ci_hyp_neither&quot;</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;percentage of each item:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;percentage of each item:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>percentage<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>##        ci_only       hyp_only    ci_hyp_both ci_hyp_neither 
##     0.09759635     0.28081509     0.64065520     0.07232979
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;standard error of each item:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;standard error of each item:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>percentage_se<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>##        ci_only       hyp_only    ci_hyp_both ci_hyp_neither 
##     0.01948951     0.02951906     0.03174408     0.01701208
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>get_ci_str <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> se<span class="token punctuation">,</span> alpha <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    z <span class="token operator">&lt;-</span> qnorm<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> alpha <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span>
    lower <span class="token operator">&lt;-</span> p <span class="token operator">-</span> z <span class="token operator">*</span> se
    upper <span class="token operator">&lt;-</span> p <span class="token operator">+</span> z <span class="token operator">*</span> se
    return<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>lower<span class="token punctuation">,</span> upper<span class="token punctuation">,</span> sep <span class="token operator">=</span> <span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;95% confidence interval of each item:&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of each item:&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>get_ci_str<span class="token punctuation">(</span>
    percentage<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">,</span>
    percentage_se<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;0.0593976194810038, 0.135795086413498&quot; &quot;0.222958791632194, 0.338671396791743&quot;  &quot;0.57843794710554, 0.702872450603153&quot;   &quot;0.0389867267523651, 0.105672844268486&quot;
</code></pre></div><h3 id="d-2"><a href="#d-2" class="header-anchor">#</a> d</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>ajph_author_mean <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>ajph<span class="token operator">$</span>NumAuthors<span class="token punctuation">)</span>
ajpm_author_mean <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>ajpm<span class="token operator">$</span>NumAuthors<span class="token punctuation">)</span>
pm_author_mean <span class="token operator">&lt;-</span> mean<span class="token punctuation">(</span>pm<span class="token operator">$</span>NumAuthors<span class="token punctuation">)</span>
weighted_author_mean <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>c<span class="token punctuation">(</span>ajph_author_mean<span class="token punctuation">,</span> ajpm_author_mean<span class="token punctuation">,</span> pm_author_mean<span class="token punctuation">)</span> <span class="token operator">/</span> weight<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;weighted mean of number of authors:&quot;</span><span class="token punctuation">,</span> weighted_author_mean<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;weighted mean of number of authors: 6.1059876188221&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>author_se <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>journal_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> c<span class="token punctuation">(</span>
    get_se<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>ajph<span class="token operator">$</span>NumAuthors<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    get_se<span class="token punctuation">(</span><span class="token number">38</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>ajpm<span class="token operator">$</span>NumAuthors<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    get_se<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>pm<span class="token operator">$</span>NumAuthors<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>journal_pop<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;standard error of weighted mean of number of authors:&quot;</span><span class="token punctuation">,</span> author_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;standard error of weighted mean of number of authors: 0.0270781952868627&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;95% confidence interval of weighted mean of number of authors:&quot;</span><span class="token punctuation">,</span>
    get_ci_str<span class="token punctuation">(</span>weighted_author_mean<span class="token punctuation">,</span> author_se<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of weighted mean of number of authors: 6.0529153312935, 6.15905990635069&quot;
</code></pre></div><h3 id="e-2"><a href="#e-2" class="header-anchor">#</a> e</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>needed_percentage <span class="token operator">&lt;-</span> <span class="token string">&quot;sel_assn_neither&quot;</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;percentage of each item:&quot;</span><span class="token punctuation">,</span> percentage<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;percentage of each item: 0.666861707904618&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;standard error of each item:&quot;</span><span class="token punctuation">,</span> percentage_se<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;standard error of each item: 0.0327393964526763&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;95% confidence interval of each item:&quot;</span><span class="token punctuation">,</span>
    get_ci_str<span class="token punctuation">(</span>percentage<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">,</span> percentage_se<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of each item: 0.602693669981794, 0.731029745827442&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;total number of articles of each item given percentage:&quot;</span><span class="token punctuation">,</span>
    round<span class="token punctuation">(</span>percentage<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span> <span class="token operator">*</span> sum<span class="token punctuation">(</span>journal_pop<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;total number of articles of each item given percentage: 365&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    &quot;<span class="token number">95</span>% confidence interval of total number of articles
    of each item given percentage<span class="token operator">:</span>&quot;<span class="token punctuation">,</span>
    get_ci_str<span class="token punctuation">(</span>
        percentage<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span> <span class="token operator">*</span> sum<span class="token punctuation">(</span>journal_pop<span class="token punctuation">)</span><span class="token punctuation">,</span>
        percentage_se<span class="token punctuation">[</span>needed_percentage<span class="token punctuation">]</span> <span class="token operator">*</span> sum<span class="token punctuation">(</span>journal_pop<span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of total number of articles\n    of each item given percentage: 329.673437480042, 399.873270967611&quot;
</code></pre></div><h2 id="_3-8-16"><a href="#_3-8-16" class="header-anchor">#</a> 3.8.16</h2> <h3 id="a-4"><a href="#a-4" class="header-anchor">#</a> a</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>n_tow <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
average_bushel_per_tow <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.44</span><span class="token punctuation">,</span> <span class="token number">1.17</span><span class="token punctuation">,</span> <span class="token number">3.92</span><span class="token punctuation">,</span> <span class="token number">1.8</span><span class="token punctuation">)</span>
sample_var <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.068</span><span class="token punctuation">,</span> <span class="token number">0.042</span><span class="token punctuation">,</span> <span class="token number">2.146</span><span class="token punctuation">,</span> <span class="token number">0.794</span><span class="token punctuation">)</span>
area <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">222.81</span><span class="token punctuation">,</span> <span class="token number">49.61</span><span class="token punctuation">,</span> <span class="token number">50.25</span><span class="token punctuation">,</span> <span class="token number">197.81</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str:&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span><span class="token number">25.6</span> <span class="token operator">*</span> area <span class="token operator">*</span> average_bushel_per_tow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str: 18153.42336&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str_se:&quot;</span><span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span><span class="token number">25.6</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> area<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> sample_var <span class="token operator">/</span> n_tow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str_se: 2412.53282090177&quot;
</code></pre></div><h3 id="b-3"><a href="#b-3" class="header-anchor">#</a> b</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>n_tow <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
average_bushel_per_tow <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.63</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">)</span>
sample_var <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.083</span><span class="token punctuation">,</span> <span class="token number">0.046</span><span class="token punctuation">)</span>
area <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">322.67</span><span class="token punctuation">,</span> <span class="token number">197.81</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str:&quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span><span class="token number">25.6</span> <span class="token operator">*</span> area <span class="token operator">*</span> average_bushel_per_tow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str: 7229.59616&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str_se:&quot;</span><span class="token punctuation">,</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span><span class="token number">25.6</span><span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> area<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> sample_var <span class="token operator">/</span> n_tow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str_se: 971.515003588101&quot;
</code></pre></div><h2 id="_3-8-19"><a href="#_3-8-19" class="header-anchor">#</a> 3.8.19</h2> <h3 id="b-4"><a href="#b-4" class="header-anchor">#</a> b</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>n_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">407</span><span class="token punctuation">,</span> <span class="token number">811</span><span class="token punctuation">)</span>
n <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">3.925</span><span class="token punctuation">,</span> <span class="token number">3.938</span><span class="token punctuation">,</span> <span class="token number">3.942</span><span class="token punctuation">)</span>
s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token number">0.037</span><span class="token punctuation">,</span> <span class="token number">0.052</span><span class="token punctuation">,</span> <span class="token number">0.07</span><span class="token punctuation">)</span>
y_u <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>n_pop <span class="token operator">*</span> y_h<span class="token punctuation">)</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>n_pop<span class="token punctuation">)</span>
y_u_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>n_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> s_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>n_pop<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;y_u:&quot;</span><span class="token punctuation">,</span> y_u<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;y_u: 3.93854971590909&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;y_u_se:&quot;</span><span class="token punctuation">,</span> y_u_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;y_u_se: 0.0433190239006885&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;95% confidence interval of y_u:&quot;</span><span class="token punctuation">,</span> get_ci_str<span class="token punctuation">(</span>y_u<span class="token punctuation">,</span> y_u_se<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of y_u: 3.85364598921831, 4.02345344259987&quot;
</code></pre></div><h3 id="c-4"><a href="#c-4" class="header-anchor">#</a> c</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>get_u <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    return<span class="token punctuation">(</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span> <span class="token operator">/</span> sqrt<span class="token punctuation">(</span>s1<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">/</span> n1 <span class="token operator">+</span> s2<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">/</span> n2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
u1 <span class="token operator">&lt;-</span> get_u<span class="token punctuation">(</span><span class="token number">3.925</span><span class="token punctuation">,</span> <span class="token number">3.938</span><span class="token punctuation">,</span> <span class="token number">0.037</span><span class="token punctuation">,</span> <span class="token number">0.052</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span>
u2 <span class="token operator">&lt;-</span> get_u<span class="token punctuation">(</span><span class="token number">3.925</span><span class="token punctuation">,</span> <span class="token number">3.942</span><span class="token punctuation">,</span> <span class="token number">0.037</span><span class="token punctuation">,</span> <span class="token number">0.07</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
u3 <span class="token operator">&lt;-</span> get_u<span class="token punctuation">(</span><span class="token number">3.938</span><span class="token punctuation">,</span> <span class="token number">3.942</span><span class="token punctuation">,</span> <span class="token number">0.052</span><span class="token punctuation">,</span> <span class="token number">0.07</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
a <span class="token operator">&lt;-</span> <span class="token number">0.05</span>
u_a <span class="token operator">&lt;-</span> qnorm<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
print<span class="token punctuation">(</span>u1<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>## [1] -0.8088223
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>u2<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] -1.001878
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>u3<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] -0.1961468
</code></pre></div><h2 id="_3-8-24"><a href="#_3-8-24" class="header-anchor">#</a> 3.8.24</h2> <h3 id="b-5"><a href="#b-5" class="header-anchor">#</a> b</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>radon <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">&quot;./sampling/radon.csv&quot;</span><span class="token punctuation">)</span>
unique_radon <span class="token operator">&lt;-</span> radon<span class="token punctuation">[</span><span class="token operator">!</span>duplicated<span class="token punctuation">(</span>radon<span class="token operator">$</span>countyname<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>
weight <span class="token operator">&lt;-</span> unique_radon<span class="token operator">$</span>popsize <span class="token operator">/</span> unique_radon<span class="token operator">$</span>sampsize
print<span class="token punctuation">(</span>weight<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>##  [1] 1350.00000 1261.40351 2750.00000 1642.85714 2375.00000  966.66667 1328.57143 2550.00000  954.54545 2350.00000 1680.00000 1120.00000 1666.66667 1146.66667  775.00000
## [16]  900.00000 1300.00000 1433.33333 1150.72464 1833.33333 1036.36364 1216.66667 3950.00000 1340.00000  973.33333 3298.31933 1066.66667 1140.00000 2250.00000 1383.33333
## [31]  685.71429 1225.00000 3525.00000  766.66667  688.88889 1900.00000  440.00000  300.00000 1450.00000  725.00000  900.00000 1600.00000  500.00000 1212.50000  853.84615
## [46] 1540.00000 2400.00000 1030.00000 1064.28571 3900.00000 2375.00000 2600.00000 1100.00000 1388.46154 1809.09091 1425.00000 1250.00000 1025.00000 3125.00000 2300.00000
## [61] 4307.14286 1340.00000 2466.66667 1445.45455 1266.66667  335.71429   66.39344 1178.57143 1233.33333 1375.00000 1333.33333 1100.00000 1850.00000 1175.00000 2350.00000
## [76]  340.00000 1057.14286 1000.00000 1725.00000  848.00000 1566.66667 2800.00000 1238.46154 1542.85714 1533.33333
</code></pre></div><h3 id="c-5"><a href="#c-5" class="header-anchor">#</a> c</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
y_log_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
s_log_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_log_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> unique_radon<span class="token operator">$</span>countyname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    samp <span class="token operator">&lt;-</span> radon<span class="token punctuation">[</span>radon<span class="token operator">$</span>countyname <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>radon
    y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>y_h<span class="token punctuation">,</span> mean<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    y_log_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>y_log_h<span class="token punctuation">,</span> mean<span class="token punctuation">(</span>log<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>s_h<span class="token punctuation">,</span> var<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    s_log_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>s_log_h<span class="token punctuation">,</span> var<span class="token punctuation">(</span>log<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>se_h<span class="token punctuation">,</span> get_se<span class="token punctuation">(</span>
        length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span>
        unique_radon<span class="token punctuation">[</span>unique_radon<span class="token operator">$</span>countyname <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>popsize
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
    se_log_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>se_log_h<span class="token punctuation">,</span> get_se<span class="token punctuation">(</span>
        length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>log<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        unique_radon<span class="token punctuation">[</span>unique_radon<span class="token operator">$</span>countyname <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>popsize
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
y_str <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> weight <span class="token operator">*</span> y_h<span class="token punctuation">)</span>
y_str_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> weight<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;y_str:&quot;</span><span class="token punctuation">,</span> y_str<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;y_str: 0.426129501525577&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;y_str_se:&quot;</span><span class="token punctuation">,</span> y_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;y_str_se: 0.0194773447597766&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;95% confidence interval of y_str:&quot;</span><span class="token punctuation">,</span> get_ci_str<span class="token punctuation">(</span>y_str<span class="token punctuation">,</span> y_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of y_str: 0.387954607281945, 0.464304395769209&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>y_log_str <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> weight <span class="token operator">*</span> y_log_h<span class="token punctuation">)</span>
y_log_str_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> weight<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_log_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;y_log_str:&quot;</span><span class="token punctuation">,</span> y_log_str<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;y_log_str: 0.106584753488187&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;y_log_str_se:&quot;</span><span class="token punctuation">,</span> y_log_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;y_log_str_se: 0.0031933631095221&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span>
    <span class="token string">&quot;95% confidence interval of y_log_str:&quot;</span><span class="token punctuation">,</span>
    get_ci_str<span class="token punctuation">(</span>y_log_str<span class="token punctuation">,</span> y_log_str_se<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of y_log_str: 0.100325876803965, 0.112843630172409&quot;
</code></pre></div><h3 id="d-3"><a href="#d-3" class="header-anchor">#</a> d</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>p_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> unique_radon<span class="token operator">$</span>countyname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    samp <span class="token operator">&lt;-</span> radon<span class="token punctuation">[</span>radon<span class="token operator">$</span>countyname <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>radon
    p <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>samp <span class="token operator">&gt;=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">/</span> length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span>
    p_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>p_h<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>se_h<span class="token punctuation">,</span> get_se_p<span class="token punctuation">(</span>
        p<span class="token punctuation">,</span> length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span>
        unique_radon<span class="token punctuation">[</span>unique_radon<span class="token operator">$</span>countyname <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>popsize
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
p_str <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> weight <span class="token operator">*</span> p_h<span class="token punctuation">)</span>
p_str_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> weight<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;p_str:&quot;</span><span class="token punctuation">,</span> p_str<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;p_str: 0.0374878589744666&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;p_str_se:&quot;</span><span class="token punctuation">,</span> p_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;p_str_se: 0.00189804582869492&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;95% confidence interval of p_str:&quot;</span><span class="token punctuation">,</span> get_ci_str<span class="token punctuation">(</span>p_str<span class="token punctuation">,</span> p_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of p_str: 0.0337677575092181, 0.0412079604397151&quot;
</code></pre></div><h2 id="_3-8-49"><a href="#_3-8-49" class="header-anchor">#</a> 3.8.49</h2> <h3 id="a-5"><a href="#a-5" class="header-anchor">#</a> a</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>vius <span class="token operator">&lt;-</span> read.csv<span class="token punctuation">(</span><span class="token string">&quot;./sampling/vius.csv&quot;</span><span class="token punctuation">)</span>
strat <span class="token operator">&lt;-</span> unique<span class="token punctuation">(</span>vius<span class="token operator">$</span>stratum<span class="token punctuation">)</span>
n_pop <span class="token operator">&lt;-</span> <span class="token number">0</span>
n_h_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> strat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    n_h_pop_temp <span class="token operator">&lt;-</span> nrow<span class="token punctuation">(</span>vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span>
        unique<span class="token punctuation">(</span>vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>tabtrucks<span class="token punctuation">)</span>
    n_h_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>n_h_pop<span class="token punctuation">,</span> n_h_pop_temp<span class="token punctuation">)</span>
    n_pop <span class="token operator">&lt;-</span> n_pop <span class="token operator">+</span> n_h_pop_temp
<span class="token punctuation">}</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;n_pop:&quot;</span><span class="token punctuation">,</span> n_pop<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;n_pop: 85174775.7713&quot;
</code></pre></div><h3 id="b-6"><a href="#b-6" class="header-anchor">#</a> b</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> strat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    samp <span class="token operator">&lt;-</span> vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>miles_annl
    y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>y_h<span class="token punctuation">,</span> mean<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>s_h<span class="token punctuation">,</span> var<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>se_h<span class="token punctuation">,</span> get_se<span class="token punctuation">(</span>
        length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span>
        nrow<span class="token punctuation">(</span>vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span>
            unique<span class="token punctuation">(</span>vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>tabtrucks<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
t_str <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>n_h_pop <span class="token operator">*</span> y_h<span class="token punctuation">)</span>
t_str_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>n_h_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str:&quot;</span><span class="token punctuation">,</span> t_str<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str: 1114727883442.98&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str_se:&quot;</span><span class="token punctuation">,</span> t_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str_se: 6491502011.79138&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;95% confidence interval of t_str:&quot;</span><span class="token punctuation">,</span> get_ci_str<span class="token punctuation">(</span>t_str<span class="token punctuation">,</span> t_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of t_str: 1102004773294.3, 1127450993591.66&quot;
</code></pre></div><h3 id="c-6"><a href="#c-6" class="header-anchor">#</a> c</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>get_estimate_sub <span class="token operator">&lt;-</span> <span class="token keyword">function</span><span class="token punctuation">(</span>sub_total<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    strat <span class="token operator">&lt;-</span> unique<span class="token punctuation">(</span>sub_total<span class="token operator">$</span>stratum<span class="token punctuation">)</span>
    n <span class="token operator">&lt;-</span> <span class="token number">0</span>
    n_h_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> strat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        n_h_pop_temp <span class="token operator">&lt;-</span> nrow<span class="token punctuation">(</span>sub_total<span class="token punctuation">[</span>sub_total<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span>
            unique<span class="token punctuation">(</span>sub_total<span class="token punctuation">[</span>sub_total<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>tabtrucks<span class="token punctuation">)</span>
        n_h_pop <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>n_h_pop<span class="token punctuation">,</span> n_h_pop_temp<span class="token punctuation">)</span>
        n <span class="token operator">&lt;-</span> n <span class="token operator">+</span> n_h_pop_temp
    <span class="token punctuation">}</span>
    y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
    s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
    se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> strat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        samp <span class="token operator">&lt;-</span> sub_total<span class="token punctuation">[</span>sub_total<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>miles_annl
        y_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>y_h<span class="token punctuation">,</span> mean<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        s_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>s_h<span class="token punctuation">,</span> var<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>se_h<span class="token punctuation">,</span> get_se<span class="token punctuation">(</span>
            length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span> var<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span>
            nrow<span class="token punctuation">(</span>sub_total<span class="token punctuation">[</span>sub_total<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span>
                unique<span class="token punctuation">(</span>sub_total<span class="token punctuation">[</span>sub_total<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>tabtrucks<span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    t_str <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>n_h_pop <span class="token operator">*</span> y_h<span class="token punctuation">)</span>
    t_str_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>n_h_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    return<span class="token punctuation">(</span>c<span class="token punctuation">(</span>t_str<span class="token punctuation">,</span> t_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

trucktype_estimate <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    trucktype_sub <span class="token operator">&lt;-</span> vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>trucktype <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span>
    trucktype_estimate <span class="token operator">&lt;-</span> rbind<span class="token punctuation">(</span>trucktype_estimate<span class="token punctuation">,</span> get_estimate_sub<span class="token punctuation">(</span>trucktype_sub<span class="token punctuation">)</span><span class="token punctuation">)</span>
    print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;trucktype&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">&quot;mile:&quot;</span><span class="token punctuation">,</span> trucktype_estimate<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;95% confidence interval of trucktype&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">,</span> get_ci_str<span class="token punctuation">(</span>trucktype_estimate<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> trucktype_estimate<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;trucktype 1 mile: 428294502081.533&quot;
## [1] &quot;95% confidence interval of trucktype 1 : 419066075395.953, 437522928767.113&quot;
## [1] &quot;trucktype 2 mile: 541099850892.526&quot;
## [1] &quot;95% confidence interval of trucktype 2 : 532460941180.784, 549738760604.268&quot;
## [1] &quot;trucktype 3 mile: 41279084489.5836&quot;
## [1] &quot;95% confidence interval of trucktype 3 : 40505035569.0027, 42053133410.1645&quot;
## [1] &quot;trucktype 4 mile: 31752656136.6691&quot;
## [1] &quot;95% confidence interval of trucktype 4 : 31073376550.8071, 32431935722.5311&quot;
## [1] &quot;trucktype 5 mile: 72301789842.6664&quot;
## [1] &quot;95% confidence interval of trucktype 5 : 71290681901.1136, 73312897784.2192&quot;
</code></pre></div><h3 id="d-4"><a href="#d-4" class="header-anchor">#</a> d</h3> <div class="language-r line-numbers-mode"><pre class="language-r"><code>vius<span class="token operator">$</span>exceed_10 <span class="token operator">&lt;-</span> vius<span class="token operator">$</span>vius_gvw <span class="token operator">&gt;</span> <span class="token number">3</span>
p_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> strat<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    samp <span class="token operator">&lt;-</span> vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>exceed_10
    p <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>samp<span class="token punctuation">)</span> <span class="token operator">/</span> length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span>
    p_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>p_h<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    se_h <span class="token operator">&lt;-</span> c<span class="token punctuation">(</span>se_h<span class="token punctuation">,</span> get_se_p<span class="token punctuation">(</span>
        p<span class="token punctuation">,</span> length<span class="token punctuation">(</span>samp<span class="token punctuation">)</span><span class="token punctuation">,</span>
        nrow<span class="token punctuation">(</span>vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span>
            unique<span class="token punctuation">(</span>vius<span class="token punctuation">[</span>vius<span class="token operator">$</span>stratum <span class="token operator">==</span> i<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token operator">$</span>tabtrucks<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
p_str <span class="token operator">&lt;-</span> sum<span class="token punctuation">(</span>n_h_pop <span class="token operator">*</span> p_h<span class="token punctuation">)</span> <span class="token operator">/</span> n_pop
p_str_se <span class="token operator">&lt;-</span> sqrt<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>n_h_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">/</span> n_pop<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">*</span> se_h<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
t_str <span class="token operator">&lt;-</span> n_pop <span class="token operator">*</span> p_str
t_str_se <span class="token operator">&lt;-</span> n_pop <span class="token operator">*</span> p_str_se
print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str:&quot;</span><span class="token punctuation">,</span> t_str<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str: 5415208.731&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;t_str_se:&quot;</span><span class="token punctuation">,</span> t_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;t_str_se: 65334.6409275265&quot;
</code></pre></div><div class="language-r line-numbers-mode"><pre class="language-r"><code>print<span class="token punctuation">(</span>paste<span class="token punctuation">(</span><span class="token string">&quot;95% confidence interval of t_str:&quot;</span><span class="token punctuation">,</span> get_ci_str<span class="token punctuation">(</span>t_str<span class="token punctuation">,</span> t_str_se<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>## [1] &quot;95% confidence interval of t_str: 5287155.18783919, 5543262.27416081&quot;
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c81839fd.js" defer></script><script src="/assets/js/2.1ffc7243.js" defer></script><script src="/assets/js/1.21765641.js" defer></script><script src="/assets/js/52.30dae559.js" defer></script>
  </body>
</html>

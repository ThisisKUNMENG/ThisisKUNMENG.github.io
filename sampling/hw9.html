<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>抽样调查第九周作业</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.c81839fd.js" as="script"><link rel="preload" href="/assets/js/2.1ffc7243.js" as="script"><link rel="preload" href="/assets/js/1.21765641.js" as="script"><link rel="preload" href="/assets/js/34.1c144145.js" as="script"><link rel="prefetch" href="/assets/js/10.94d9ae37.js"><link rel="prefetch" href="/assets/js/11.f71277c4.js"><link rel="prefetch" href="/assets/js/12.df91b8c5.js"><link rel="prefetch" href="/assets/js/13.ccf34248.js"><link rel="prefetch" href="/assets/js/14.cec430ee.js"><link rel="prefetch" href="/assets/js/15.075f2557.js"><link rel="prefetch" href="/assets/js/16.050b0744.js"><link rel="prefetch" href="/assets/js/17.e6b2d62e.js"><link rel="prefetch" href="/assets/js/18.e1f699c1.js"><link rel="prefetch" href="/assets/js/19.43923341.js"><link rel="prefetch" href="/assets/js/20.b20e711d.js"><link rel="prefetch" href="/assets/js/21.8dd3e2d2.js"><link rel="prefetch" href="/assets/js/22.bfe29ee7.js"><link rel="prefetch" href="/assets/js/23.d6610626.js"><link rel="prefetch" href="/assets/js/24.922a5ac7.js"><link rel="prefetch" href="/assets/js/25.082050c9.js"><link rel="prefetch" href="/assets/js/26.64d32bef.js"><link rel="prefetch" href="/assets/js/27.429314cf.js"><link rel="prefetch" href="/assets/js/28.6d085cc4.js"><link rel="prefetch" href="/assets/js/29.03a256fd.js"><link rel="prefetch" href="/assets/js/3.689860d5.js"><link rel="prefetch" href="/assets/js/30.1af4f8c4.js"><link rel="prefetch" href="/assets/js/31.5eec4937.js"><link rel="prefetch" href="/assets/js/32.b31e0c94.js"><link rel="prefetch" href="/assets/js/33.0057f8d5.js"><link rel="prefetch" href="/assets/js/35.997e4046.js"><link rel="prefetch" href="/assets/js/36.73c2dac3.js"><link rel="prefetch" href="/assets/js/37.0efd73ec.js"><link rel="prefetch" href="/assets/js/38.d3b0fd9d.js"><link rel="prefetch" href="/assets/js/39.1f488157.js"><link rel="prefetch" href="/assets/js/4.8c775bf3.js"><link rel="prefetch" href="/assets/js/40.3f735ee0.js"><link rel="prefetch" href="/assets/js/41.0b3072ca.js"><link rel="prefetch" href="/assets/js/42.f2deac56.js"><link rel="prefetch" href="/assets/js/43.2925ac95.js"><link rel="prefetch" href="/assets/js/44.15b774a6.js"><link rel="prefetch" href="/assets/js/45.4a73b893.js"><link rel="prefetch" href="/assets/js/46.ff126056.js"><link rel="prefetch" href="/assets/js/47.a8af33bb.js"><link rel="prefetch" href="/assets/js/48.fd9bfbfb.js"><link rel="prefetch" href="/assets/js/49.d1bb8a6b.js"><link rel="prefetch" href="/assets/js/5.4038169b.js"><link rel="prefetch" href="/assets/js/50.261e0b1b.js"><link rel="prefetch" href="/assets/js/51.ad5e908a.js"><link rel="prefetch" href="/assets/js/52.30dae559.js"><link rel="prefetch" href="/assets/js/53.5928da48.js"><link rel="prefetch" href="/assets/js/54.b392dbf9.js"><link rel="prefetch" href="/assets/js/55.02dbfb4e.js"><link rel="prefetch" href="/assets/js/6.bdb8c543.js"><link rel="prefetch" href="/assets/js/7.7ea37c1e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.be90ab07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>抽样调查第九周作业</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sampling/hw9.html#_4-18" class="sidebar-link">4.18</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw9.html#a" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw9.html#b" class="sidebar-link">b</a></li></ul></li><li><a href="/sampling/hw9.html#_2补充" class="sidebar-link">2补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw9.html#a-2" class="sidebar-link">a</a></li><li class="sidebar-sub-header"><a href="/sampling/hw9.html#b-2" class="sidebar-link">b</a></li><li class="sidebar-sub-header"><a href="/sampling/hw9.html#c" class="sidebar-link">c</a></li><li class="sidebar-sub-header"><a href="/sampling/hw9.html#d" class="sidebar-link">d</a></li></ul></li><li><a href="/sampling/hw9.html#_5-8-11" class="sidebar-link">5.8.11</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sampling/hw9.html#a-3" class="sidebar-link">a</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_4-18"><a href="#_4-18" class="header-anchor">#</a> 4.18</h2> <h3 id="a"><a href="#a" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>mystery <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/mysteries.csv'</span><span class="token punctuation">)</span>
mystery_group <span class="token operator">=</span> mystery<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;stratum&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>male_female_h <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>
    mystery_group<span class="token punctuation">[</span><span class="token string">&quot;authorgender&quot;</span><span class="token punctuation">]</span>\
    <span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\
    <span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">[</span>x<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&quot;F&quot;</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\
    <span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
weights <span class="token operator">=</span> mystery_group<span class="token punctuation">[</span><span class="token string">&quot;p1weight&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>x_bar <span class="token operator">=</span> <span class="token punctuation">(</span>male_female_h<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> weights<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
y_bar <span class="token operator">=</span> <span class="token punctuation">(</span>male_female_h<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> weights<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
b_hat <span class="token operator">=</span>  y_bar <span class="token operator">/</span> x_bar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>ei <span class="token operator">=</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;authorgender&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> y<span class="token punctuation">:</span> <span class="token punctuation">(</span>y<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span> <span class="token operator">-</span> b_hat <span class="token operator">*</span> y<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">&quot;F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
fpc <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">60</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">655</span>
b_hat_var <span class="token operator">=</span> <span class="token punctuation">(</span>ei <span class="token operator">*</span> weights<span class="token punctuation">)</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> fpc <span class="token operator">/</span> <span class="token punctuation">(</span>x_bar <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>b_hat_ci <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>b_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>b_hat_var<span class="token punctuation">)</span><span class="token punctuation">,</span> b_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>b_hat_var<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;b_hat: </span><span class="token interpolation"><span class="token punctuation">{</span>b_hat<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;b_hat_var: </span><span class="token interpolation"><span class="token punctuation">{</span>b_hat_var<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;b_hat_ci: </span><span class="token interpolation"><span class="token punctuation">{</span>b_hat_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>b_hat: 2.207505518781457
b_hat_var: 0.00145783268500254
b_hat_ci: [2.13266963 2.28234141]
</code></pre></div><h3 id="b"><a href="#b" class="header-anchor">#</a> b</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>md_t <span class="token operator">=</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;mdetect&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;p1weight&quot;</span><span class="token punctuation">]</span>
fd_t <span class="token operator">=</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;fdetect&quot;</span><span class="token punctuation">]</span> <span class="token operator">*</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;p1weight&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>b_hat <span class="token operator">=</span> fd_t<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> md_t<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>ei <span class="token operator">=</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;mdetect&quot;</span><span class="token punctuation">]</span> <span class="token operator">-</span> b_hat <span class="token operator">*</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;fdetect&quot;</span><span class="token punctuation">]</span>
b_hat_var <span class="token operator">=</span> <span class="token punctuation">(</span>ei <span class="token operator">*</span> mystery<span class="token punctuation">[</span><span class="token string">&quot;p1weight&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> fpc <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fd_t<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>b_hat_ci <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>b_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>b_hat_var<span class="token punctuation">)</span><span class="token punctuation">,</span> b_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>b_hat_var<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;b_hat: </span><span class="token interpolation"><span class="token punctuation">{</span>b_hat<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;b_hat_ci: </span><span class="token interpolation"><span class="token punctuation">{</span>b_hat_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>b_hat: 0.2558364582053497
b_hat_ci: [-0.67775425  1.18942716]
</code></pre></div><h2 id="_2补充"><a href="#_2补充" class="header-anchor">#</a> 2补充</h2> <h3 id="a-2"><a href="#a-2" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>agpop <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/agpop.csv'</span><span class="token punctuation">)</span>
agstrat <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/agstrat.csv'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>agpop_region <span class="token operator">=</span> agpop<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;region&quot;</span><span class="token punctuation">)</span>
agstrat_region <span class="token operator">=</span> agstrat<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;region&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>xhu_bar <span class="token operator">=</span> agpop_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_u_bar <span class="token operator">=</span> agpop<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;xhu_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>xhu_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;x_u_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>x_u_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>xhu_bar: region
NC    332487.292220
NE    100126.845455
S     203019.015195
W     735598.627962
Name: acres87, dtype: float64
x_u_bar: 313016.37816764135
</code></pre></div><h3 id="b-2"><a href="#b-2" class="header-anchor">#</a> b</h3> <ul><li>分别比估计</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>N <span class="token operator">=</span> agpop<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
n_h <span class="token operator">=</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
N_h <span class="token operator">=</span> agpop_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
W_h <span class="token operator">=</span> N_h <span class="token operator">/</span> N
fpc_h <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>n_h <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N_h
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>b_h_hat <span class="token operator">=</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_rs_bar <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>N <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>b_h_hat <span class="token operator">*</span> agpop_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_rs_bar_var <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>
    W_h <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> fpc_h <span class="token operator">*</span>
    <span class="token punctuation">(</span>
            agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_h_hat <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'acres87'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'acres92'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> b_h_hat <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_rs_bar_ci <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>y_rs_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_rs_bar_var<span class="token punctuation">)</span><span class="token punctuation">,</span> y_rs_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_rs_bar_var<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rs_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>y_rs_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rs_bar_var: </span><span class="token interpolation"><span class="token punctuation">{</span>y_rs_bar_var<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rs_bar_se: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_rs_bar_var<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rs_bar_ci: </span><span class="token interpolation"><span class="token punctuation">{</span>y_rs_bar_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>y_rs_bar: 310050.0749555694
y_rs_bar_var: 3277183.202007093
y_rs_bar_se: 1810.2992023439365
y_rs_bar_ci: [306501.88851898 313598.26139216]
</code></pre></div><ul><li>联合比估计</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>b_hat <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>N_h <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>N_h <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_rc_bar <span class="token operator">=</span> b_hat <span class="token operator">*</span> x_u_bar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_rc_bar_var <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>
    W_h <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> fpc_h <span class="token operator">*</span>
    <span class="token punctuation">(</span>
            agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_hat <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'acres87'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'acres92'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> b_hat <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_rc_bar_ci <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>y_rc_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_rc_bar_var<span class="token punctuation">)</span><span class="token punctuation">,</span> y_rc_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_rc_bar_var<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rc_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>y_rc_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rc_bar_var: </span><span class="token interpolation"><span class="token punctuation">{</span>y_rc_bar_var<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rc_bar_se: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_rc_bar_var<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_rc_bar_ci: </span><span class="token interpolation"><span class="token punctuation">{</span>y_rc_bar_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>y_rc_bar: 309305.8056693079
y_rc_bar_var: 3422373.3277662937
y_rc_bar_se: 1849.9657639443747
y_rc_bar_ci: [305679.87277198 312931.73856664]
</code></pre></div><h3 id="c"><a href="#c" class="header-anchor">#</a> c</h3> <ul><li>分别回归估计</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>b_1h_hat <span class="token operator">=</span> agstrat_region<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'acres87'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'acres92'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_h_bar <span class="token operator">=</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_h_bar <span class="token operator">=</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
y_reg_s_bar <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>W_h <span class="token operator">*</span> <span class="token punctuation">(</span>y_h_bar <span class="token operator">+</span> b_1h_hat <span class="token operator">*</span> <span class="token punctuation">(</span>xhu_bar <span class="token operator">-</span> x_h_bar<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_reg_s_bar_var <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>
    W_h <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> fpc_h <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span>
    <span class="token punctuation">(</span>
            <span class="token number">1</span> <span class="token operator">-</span> agstrat_region<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'acres87'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'acres92'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_reg_s_bar_ci <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>y_reg_s_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_reg_s_bar_var<span class="token punctuation">)</span><span class="token punctuation">,</span> y_reg_s_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_reg_s_bar_var<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_s_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>y_reg_s_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_s_bar_var: </span><span class="token interpolation"><span class="token punctuation">{</span>y_reg_s_bar_var<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_s_bar_se: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_reg_s_bar_var<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_s_bar_ci: </span><span class="token interpolation"><span class="token punctuation">{</span>y_reg_s_bar_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>y_reg_s_bar: 310511.97728841845
y_reg_s_bar_var: 1581589.5853079702
y_reg_s_bar_se: 1257.6126531281284
y_reg_s_bar_ci: [308047.05648829 312976.89808855]
</code></pre></div><ul><li>联合回归估计</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>b_1_hat <span class="token operator">=</span> <span class="token punctuation">(</span>
        np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>
            W_h <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> fpc_h <span class="token operator">*</span>
            agstrat_region<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'acres87'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'acres92'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span> <span class="token operator">/</span>
        np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>
            W_h <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> fpc_h <span class="token operator">*</span>
            agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_str_bar <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> W_h<span class="token punctuation">)</span>
x_str_bar <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> W_h<span class="token punctuation">)</span>
y_reg_c_bar <span class="token operator">=</span> y_str_bar <span class="token operator">+</span> b_1_hat <span class="token operator">*</span> <span class="token punctuation">(</span>x_u_bar <span class="token operator">-</span> x_str_bar<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_reg_c_bar_var <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>
    W_h <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> fpc_h <span class="token operator">*</span>
    <span class="token punctuation">(</span>
            agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> b_1_hat <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;acres92&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token string">'acres87'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">'acres92'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token operator">+</span> b_1_hat <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> agstrat_region<span class="token punctuation">[</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>y_reg_c_bar_ci <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>y_reg_c_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_reg_c_bar_var<span class="token punctuation">)</span><span class="token punctuation">,</span> y_reg_c_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_reg_c_bar_var<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_c_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>y_reg_c_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_c_bar_var: </span><span class="token interpolation"><span class="token punctuation">{</span>y_reg_c_bar_var<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_c_bar_se: </span><span class="token interpolation"><span class="token punctuation">{</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>y_reg_c_bar_var<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;y_reg_c_bar_ci: </span><span class="token interpolation"><span class="token punctuation">{</span>y_reg_c_bar_ci<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>y_reg_c_bar: 310014.99012591864
y_reg_c_bar_var: 3391330.4534413912
y_reg_c_bar_se: 1841.5565300694386
y_reg_c_bar_ci: [306405.53932698 313624.44092485]
</code></pre></div><h3 id="d"><a href="#d" class="header-anchor">#</a> d</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>sns<span class="token punctuation">.</span>set_style<span class="token punctuation">(</span><span class="token string">&quot;white&quot;</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span>lmplot<span class="token punctuation">(</span>
    x<span class="token operator">=</span><span class="token string">&quot;acres87&quot;</span><span class="token punctuation">,</span>
    y<span class="token operator">=</span><span class="token string">&quot;acres92&quot;</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span>agstrat<span class="token punctuation">,</span>
    hue<span class="token operator">=</span><span class="token string">&quot;region&quot;</span><span class="token punctuation">,</span>
    palette<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'black'</span><span class="token punctuation">,</span> <span class="token string">'dimgrey'</span><span class="token punctuation">,</span> <span class="token string">'lightgrey'</span><span class="token punctuation">,</span> <span class="token string">'darkgrey'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    height<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span>
    aspect<span class="token operator">=</span><span class="token number">8</span><span class="token operator">/</span><span class="token number">6</span>
<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;figure/9_2d.pdf&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="/assets/img/hw9_40_0.c2dfda72.png" alt="png"></p> <h2 id="_5-8-11"><a href="#_5-8-11" class="header-anchor">#</a> 5.8.11</h2> <h3 id="a-3"><a href="#a-3" class="header-anchor">#</a> a</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>errors <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
M <span class="token operator">=</span> <span class="token number">215</span>
error_rate <span class="token operator">=</span> errors <span class="token operator">/</span> M
number_error <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
error_rate_all <span class="token operator">=</span> np<span class="token punctuation">.</span>repeat<span class="token punctuation">(</span>error_rate<span class="token punctuation">,</span> number_error<span class="token punctuation">)</span>
error_all <span class="token operator">=</span> np<span class="token punctuation">.</span>repeat<span class="token punctuation">(</span>errors<span class="token punctuation">,</span> number_error<span class="token punctuation">)</span>
n <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>number_error<span class="token punctuation">)</span>
N <span class="token operator">=</span> <span class="token number">828</span>
fpc <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>N
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>p_bar <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>n <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>number_error <span class="token operator">*</span> error_rate<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;p_bar: </span><span class="token interpolation"><span class="token punctuation">{</span>p_bar<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>p_bar: 0.0020246238030095756
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>p_bar_var <span class="token operator">=</span> fpc <span class="token operator">*</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error_rate_all <span class="token operator">-</span> p_bar<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
p_bar_se <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>p_bar_var<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;p_bar_var: </span><span class="token interpolation"><span class="token punctuation">{</span>p_bar_var<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;p_bar_se: </span><span class="token interpolation"><span class="token punctuation">{</span>p_bar_se<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>p_bar_var: 1.2749751318442425e-07
p_bar_se: 0.0003570679391718392
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>t_hat <span class="token operator">=</span> N <span class="token operator">/</span> n <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>error_all<span class="token punctuation">)</span>
t_hat_se <span class="token operator">=</span> p_bar_se <span class="token operator">*</span> N <span class="token operator">*</span> M
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;t_hat: </span><span class="token interpolation"><span class="token punctuation">{</span>t_hat<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;t_hat_se: </span><span class="token interpolation"><span class="token punctuation">{</span>t_hat_se<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>t_hat: 360.42352941176466
t_hat_se: 63.565234531370805
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>v_p_srs <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> n<span class="token operator">/</span>N<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>n <span class="token operator">*</span> M <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> p_bar <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> p_bar<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;v_p_srs: </span><span class="token interpolation"><span class="token punctuation">{</span>v_p_srs<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>v_p_srs: 9.921766922548389e-08
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c81839fd.js" defer></script><script src="/assets/js/2.1ffc7243.js" defer></script><script src="/assets/js/1.21765641.js" defer></script><script src="/assets/js/34.1c144145.js" defer></script>
  </body>
</html>

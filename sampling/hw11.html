<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>抽样调查第十一周作业</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.c81839fd.js" as="script"><link rel="preload" href="/assets/js/2.1ffc7243.js" as="script"><link rel="preload" href="/assets/js/1.21765641.js" as="script"><link rel="preload" href="/assets/js/29.03a256fd.js" as="script"><link rel="prefetch" href="/assets/js/10.94d9ae37.js"><link rel="prefetch" href="/assets/js/11.f71277c4.js"><link rel="prefetch" href="/assets/js/12.df91b8c5.js"><link rel="prefetch" href="/assets/js/13.ccf34248.js"><link rel="prefetch" href="/assets/js/14.cec430ee.js"><link rel="prefetch" href="/assets/js/15.075f2557.js"><link rel="prefetch" href="/assets/js/16.050b0744.js"><link rel="prefetch" href="/assets/js/17.e6b2d62e.js"><link rel="prefetch" href="/assets/js/18.e1f699c1.js"><link rel="prefetch" href="/assets/js/19.43923341.js"><link rel="prefetch" href="/assets/js/20.b20e711d.js"><link rel="prefetch" href="/assets/js/21.8dd3e2d2.js"><link rel="prefetch" href="/assets/js/22.bfe29ee7.js"><link rel="prefetch" href="/assets/js/23.d6610626.js"><link rel="prefetch" href="/assets/js/24.922a5ac7.js"><link rel="prefetch" href="/assets/js/25.082050c9.js"><link rel="prefetch" href="/assets/js/26.64d32bef.js"><link rel="prefetch" href="/assets/js/27.429314cf.js"><link rel="prefetch" href="/assets/js/28.6d085cc4.js"><link rel="prefetch" href="/assets/js/3.689860d5.js"><link rel="prefetch" href="/assets/js/30.1af4f8c4.js"><link rel="prefetch" href="/assets/js/31.5eec4937.js"><link rel="prefetch" href="/assets/js/32.b31e0c94.js"><link rel="prefetch" href="/assets/js/33.0057f8d5.js"><link rel="prefetch" href="/assets/js/34.1c144145.js"><link rel="prefetch" href="/assets/js/35.997e4046.js"><link rel="prefetch" href="/assets/js/36.73c2dac3.js"><link rel="prefetch" href="/assets/js/37.0efd73ec.js"><link rel="prefetch" href="/assets/js/38.d3b0fd9d.js"><link rel="prefetch" href="/assets/js/39.1f488157.js"><link rel="prefetch" href="/assets/js/4.8c775bf3.js"><link rel="prefetch" href="/assets/js/40.3f735ee0.js"><link rel="prefetch" href="/assets/js/41.0b3072ca.js"><link rel="prefetch" href="/assets/js/42.f2deac56.js"><link rel="prefetch" href="/assets/js/43.2925ac95.js"><link rel="prefetch" href="/assets/js/44.15b774a6.js"><link rel="prefetch" href="/assets/js/45.4a73b893.js"><link rel="prefetch" href="/assets/js/46.ff126056.js"><link rel="prefetch" href="/assets/js/47.a8af33bb.js"><link rel="prefetch" href="/assets/js/48.fd9bfbfb.js"><link rel="prefetch" href="/assets/js/49.d1bb8a6b.js"><link rel="prefetch" href="/assets/js/5.4038169b.js"><link rel="prefetch" href="/assets/js/50.261e0b1b.js"><link rel="prefetch" href="/assets/js/51.ad5e908a.js"><link rel="prefetch" href="/assets/js/52.30dae559.js"><link rel="prefetch" href="/assets/js/53.5928da48.js"><link rel="prefetch" href="/assets/js/54.b392dbf9.js"><link rel="prefetch" href="/assets/js/55.02dbfb4e.js"><link rel="prefetch" href="/assets/js/6.bdb8c543.js"><link rel="prefetch" href="/assets/js/7.7ea37c1e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.be90ab07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>抽样调查第十一周作业</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/sampling/hw11.html#_5-8-14" class="sidebar-link">5.8.14</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sampling/hw11.html#_5-8-19" class="sidebar-link">5.8.19</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sampling/hw11.html#_5-8-22" class="sidebar-link">5.8.22</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/sampling/hw11.html#_5-8-24" class="sidebar-link">5.8.24</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_5-8-14"><a href="#_5-8-14" class="header-anchor">#</a> 5.8.14</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>school <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
female_students_interviewed <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
number_of_smokers <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
female_students <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">792</span><span class="token punctuation">,</span> <span class="token number">447</span><span class="token punctuation">,</span> <span class="token number">511</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>p <span class="token operator">=</span> number_of_smokers <span class="token operator">/</span> female_students_interviewed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>p_bar <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>female_students <span class="token operator">*</span> p<span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>female_students<span class="token punctuation">)</span>
var_p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>female_students<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">29</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>female_students<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p<span class="token operator">-</span>p_bar<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">29</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>female_students<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>female_students_interviewed <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>female_students<span class="token punctuation">)</span><span class="token operator">*</span>female_students<span class="token operator">**</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span>p_bar<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> female_students_interviewed<span class="token operator">/</span><span class="token punctuation">(</span>female_students_interviewed<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
se_p <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>var_p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p_bar<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_p<span class="token punctuation">,</span> p_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_p<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>0.43117647058823527
0.23957877265361247 0.622774168522858
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>t_hat <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">29</span><span class="token operator">/</span><span class="token number">4</span> <span class="token operator">*</span> female_students <span class="token operator">*</span> p<span class="token punctuation">)</span>
var_t <span class="token operator">=</span> <span class="token number">29</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">29</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>var<span class="token punctuation">(</span>number_of_smokers<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">29</span><span class="token operator">/</span><span class="token number">4</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>female_students_interviewed <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span>female_students<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span>p_bar<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> female_students_interviewed<span class="token operator">/</span><span class="token punctuation">(</span>female_students_interviewed<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
se_t <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>var_t<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t<span class="token punctuation">,</span> t_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se_t<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>7971.375
7688.402353949749 8254.347646050252
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>msw <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>p <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>p<span class="token punctuation">)</span> <span class="token operator">*</span> female_students_interviewed<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>female_students_interviewed<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s_2 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>number_of_smokers<span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>female_students_interviewed<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>number_of_smokers<span class="token punctuation">)</span><span class="token operator">/</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>female_students_interviewed<span class="token punctuation">)</span><span class="token punctuation">)</span>
r_a_2 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> msw<span class="token operator">/</span>s_2
<span class="token keyword">print</span><span class="token punctuation">(</span>r_a_2<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>0.10363828502415473
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>m_opt <span class="token operator">=</span> np<span class="token punctuation">.</span>ceil<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">75</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>r_a_2<span class="token punctuation">)</span><span class="token operator">/</span>r_a_2<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 26</span>
n_opt <span class="token operator">=</span> <span class="token number">300</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token operator">+</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">*</span>m_opt<span class="token punctuation">)</span>  <span class="token comment"># 4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_5-8-19"><a href="#_5-8-19" class="header-anchor">#</a> 5.8.19</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>schools <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/schools.csv'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>t <span class="token operator">=</span> schools<span class="token punctuation">[</span>schools<span class="token punctuation">[</span><span class="token string">'readlevel'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'schoolid'</span><span class="token punctuation">,</span> <span class="token string">'readlevel'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
t_i <span class="token operator">=</span> t<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'schoolid'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
Mi <span class="token operator">=</span> schools<span class="token punctuation">.</span>Mi<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>schools<span class="token punctuation">.</span>schoolid<span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values
t_hat <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">75</span><span class="token operator">/</span><span class="token number">10</span><span class="token operator">*</span>Mi<span class="token operator">/</span><span class="token number">20</span> <span class="token operator">*</span> t_i<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>st <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">9</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>t_i <span class="token operator">-</span> t_hat<span class="token operator">/</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
v_wr <span class="token operator">=</span> <span class="token number">75</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> st <span class="token operator">/</span> <span class="token number">10</span>
se <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>v_wr<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_hat<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>t_hat <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se<span class="token punctuation">,</span> t_hat <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>90680.625
31950.15871732329 149411.0912826767
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_5-8-22"><a href="#_5-8-22" class="header-anchor">#</a> 5.8.22</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>agsrs <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/agsrs.csv'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>formula<span class="token punctuation">.</span>api <span class="token keyword">import</span> ols
<span class="token keyword">import</span> statsmodels<span class="token punctuation">.</span>api <span class="token keyword">as</span> sm

model <span class="token operator">=</span> ols<span class="token punctuation">(</span><span class="token string">'acres92 ~ C(state)'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>agsrs<span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">)</span>
anova_table <span class="token operator">=</span> sm<span class="token punctuation">.</span>stats<span class="token punctuation">.</span>anova_lm<span class="token punctuation">(</span>model<span class="token punctuation">,</span> typ<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
ssw <span class="token operator">=</span> anova_table<span class="token punctuation">[</span><span class="token string">'sum_sq'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Residual'</span><span class="token punctuation">]</span>
ssb <span class="token operator">=</span> anova_table<span class="token punctuation">[</span><span class="token string">'sum_sq'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C(state)'</span><span class="token punctuation">]</span>
ssto <span class="token operator">=</span> ssw <span class="token operator">+</span> ssb
msw <span class="token operator">=</span> ssw <span class="token operator">/</span> anova_table<span class="token punctuation">[</span><span class="token string">'df'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Residual'</span><span class="token punctuation">]</span>
msb <span class="token operator">=</span> ssb <span class="token operator">/</span> anova_table<span class="token punctuation">[</span><span class="token string">'df'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C(state)'</span><span class="token punctuation">]</span>
msto <span class="token operator">=</span> ssto <span class="token operator">/</span> <span class="token punctuation">(</span>anova_table<span class="token punctuation">[</span><span class="token string">'df'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Residual'</span><span class="token punctuation">]</span> <span class="token operator">+</span> anova_table<span class="token punctuation">[</span><span class="token string">'df'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C(state)'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>msw<span class="token punctuation">,</span> msb<span class="token punctuation">,</span> msto<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ssw<span class="token punctuation">,</span> ssb<span class="token punctuation">,</span> ssto<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>anova_table<span class="token punctuation">[</span><span class="token string">'df'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language- extra-class"><pre><code>59910564633.05428 488760018795.4477 118716008180.40588
15456925675328.006 20039160770613.355 35496086445941.36
C(state)     41.0
Residual    258.0
Name: df, dtype: float64
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>r_a_2 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> msw<span class="token operator">/</span>msto
<span class="token keyword">print</span><span class="token punctuation">(</span>r_a_2<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>0.4953455262578266
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>m_opt <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">15</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>r_a_2<span class="token punctuation">)</span><span class="token operator">/</span>r_a_2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m_opt<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>3.9092061275213994
</code></pre></div><h2 id="_5-8-24"><a href="#_5-8-24" class="header-anchor">#</a> 5.8.24</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>ozone <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./data/ozone.csv'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>ozone_total_data <span class="token operator">=</span> ozone<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;hr0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr7&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr8&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr9&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr10&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr11&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr12&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr13&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr14&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr15&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr16&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr17&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr18&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr19&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr20&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr21&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr22&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hr23&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>ozone_total_data <span class="token operator">=</span> ozone_total_data<span class="token punctuation">[</span><span class="token operator">~</span>np<span class="token punctuation">.</span>isnan<span class="token punctuation">(</span>ozone_total_data<span class="token punctuation">)</span><span class="token punctuation">]</span>
ozone_total_data <span class="token operator">=</span> ozone_total_data<span class="token punctuation">[</span>ozone_total_data <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>ozone_total_data<span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;./figure/5.8.24a.pdf&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="/assets/img/hw11_22_0.1bea3c58.png" alt="png"></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>ozone_total_data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>ozone_total_data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>ozone_total_data<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>25.781901489117985
11.372726868704715
26.0
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>h <span class="token operator">=</span> <span class="token number">14</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>ozone<span class="token punctuation">[</span><span class="token string">&quot;hr&quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> bins<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&quot;hr&quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&quot;./figure/5.8.24b.pdf&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="data:image/png;base64,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7aOPPjLbt283CxcuNAMGDDDbt28327dvNwcOHDDGGPPFF1+YESNGmMsuu8zs2LHD1NTUmDPOOMOUlZVFePLjs3r1auN2u83KlSvN+++/b2bOnGlSU1ODXqUUzQ4cOOB8DyWZxx9/3Gzfvt189NFHxhhjHnnkEZOammpefvll884775gpU6aYnJwc8/nnn0d48r6bNWuW8Xg85s033zSffPKJs3322WfOObfddpsZMmSI2bBhg9m6daspKCgwBQUFEZz6+M2bN8/U19eblpYW884775h58+YZl8tl/vznPxtjYmut/81/vorHmNhb8z333GPefPNN09LSYv7617+awsJCc/rpp5v29nZjTOytd8uWLSY+Pt4sWrTI7N692zz33HOmf//+5tlnn3XOiaWfWSfqlAuUkpISI+mo7Y033nDO+cc//mEmTZpkkpKSzOmnn27uuece093dHbmhT9CyZcvMkCFDTEJCghk/frzZvHlzpEcKmTfeeKPX72dJSYkx5suX7c2fP99kZGQYt9ttJk6caJqbmyM79HHqbZ2SzIoVK5xzPv/8c3P77bebQYMGmf79+5urrrrKfPLJJ5Eb+gTccsst5uyzzzYJCQnmjDPOMBMnTnTixJjYWut/8/VAibU1X3fddSYzM9MkJCSYM88801x33XVmz549zvFYW68xxrz66qtmxIgRxu12m9zcXPPUU08FHY+ln1knymWMMSf9tg0AAMA3iInnoAAAgNhCoAAAAOsQKAAAwDoECgAAsA6BAgAArEOgAAAA6xAoAADAOgQKAACwDoECICwuvvhizZkzJ9JjAIhSBAoAq9x5550aN26c3G63xowZ843n7tmzRwMHDlRqaupJmQ3AyUOgALBCd3e38+dbbrlF11133f88//rrr9f3v//9cI8GIAIIFABh09PTo/vuu09paWnyer168MEHnWMul0vLly/XlVdeqeTkZC1atEiSVFlZqdLSUp177rnfeO0HHnhAubm5uvbaa8O5BAARQqAACJtVq1YpOTlZjY2NWrJkiX7xi1+otrbWOf7ggw/qqquu0s6dO3XLLbcc83U3bNigNWvWqKqqKhxjA7BAfKQHABC7Ro0apfLycknS0KFD9cQTT6iurk4/+tGPJEk33HCDbr755j5d89///rduuukmPfvss0pJSQn5zADswB0UAGEzatSooMeZmZlqb293Hufl5fX5mrfeeqtuuOEG/eAHPzjh+QDYi0ABEDb9+vULeuxyudTT0+M8Tk5O7vM1N2zYoEcffVTx8fGKj4/XjBkz5Pf7FR8fr9///vcnPDMAO/ArHgBRpaGhQUeOHHEev/zyy1q8eLE2bdqkM888M4KTAQglAgWAVfbs2aODBw/K5/Pp888/144dOyRJw4cPV0JCgoYNGxZ0/tatWxUXF6cRI0ZEYFoA4UKgALDKz372M9XX1zuPx44dK0lqaWnROeecE6GpAJxsLmOMifQQAAAA/4knyQIAAOsQKAAAwDoECgAAsA6BAgAArEOgAAAA6xAoAADAOgQKAACwDoECAACsQ6AAAADrECgAAMA6BAoAALDO/wNyRTsiHOX9WAAAAABJRU5ErkJggg==" alt="png"></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>srs <span class="token operator">=</span> ozone<span class="token punctuation">[</span><span class="token string">&quot;hr&quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>srs<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>std<span class="token punctuation">(</span>srs<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>median<span class="token punctuation">(</span>srs<span class="token punctuation">)</span><span class="token punctuation">)</span>
var <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>srs<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>srs<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>var<span class="token punctuation">(</span>srs<span class="token punctuation">,</span> ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
se <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>var<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>srs<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se<span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>srs<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language- extra-class"><pre><code>34.964383561643835
10.728286136154654
36.0
34.20250932715018 35.72625779613749
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">sample</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> start<span class="token punctuation">,</span> interval<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">all</span> <span class="token operator">=</span> ozone<span class="token punctuation">[</span><span class="token string">&quot;hr&quot;</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">]</span>
    target <span class="token operator">=</span> <span class="token builtin">all</span><span class="token punctuation">[</span>start<span class="token punctuation">:</span><span class="token punctuation">:</span>interval<span class="token punctuation">]</span>
    <span class="token keyword">if</span> target<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">182</span><span class="token punctuation">:</span>
        target <span class="token operator">=</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target<span class="token punctuation">,</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> target

<span class="token comment"># h_select = np.random.randint(0, 95, 4)</span>
<span class="token comment"># print(h_select)  # [92 61 15 86]</span>

h_select <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">92</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
h_24<span class="token punctuation">,</span> h_start <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">divmod</span><span class="token punctuation">(</span>h_select<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token comment"># for i in range(3):</span>
<span class="token comment">#     h_sample.append(np.array(sample(h_24[i], h_start[i])))</span>
h_sample <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>sample<span class="token punctuation">(</span>h_24<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> h_start<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>N <span class="token operator">=</span> <span class="token number">96</span>
n <span class="token operator">=</span> <span class="token number">4</span>
M <span class="token operator">=</span> <span class="token number">183</span>
t_hat <span class="token operator">=</span> N<span class="token operator">/</span>n <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>h_sample<span class="token punctuation">)</span>
y_bar <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">*</span>M<span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>h_sample<span class="token punctuation">)</span>
s_2 <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>h_sample<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> t_hat<span class="token operator">/</span>N<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
se <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span>M <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>n<span class="token operator">/</span>N<span class="token punctuation">)</span><span class="token operator">*</span>s_2<span class="token operator">/</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_bar<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>y_bar <span class="token operator">-</span> <span class="token number">1.96</span> <span class="token operator">*</span> se<span class="token punctuation">,</span> y_bar <span class="token operator">+</span> <span class="token number">1.96</span> <span class="token operator">*</span> se<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language- extra-class"><pre><code>24.494513000660543
17.108133344524255 31.88089265679683
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c81839fd.js" defer></script><script src="/assets/js/2.1ffc7243.js" defer></script><script src="/assets/js/1.21765641.js" defer></script><script src="/assets/js/29.03a256fd.js" defer></script>
  </body>
</html>

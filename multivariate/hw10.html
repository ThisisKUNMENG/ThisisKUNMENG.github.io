<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Homework 10</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/github-markdown-css/2.2.1/github-markdown.css">
    <link rel="icon" href="/icon.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.c81839fd.js" as="script"><link rel="preload" href="/assets/js/2.1ffc7243.js" as="script"><link rel="preload" href="/assets/js/1.21765641.js" as="script"><link rel="preload" href="/assets/js/39.1f488157.js" as="script"><link rel="prefetch" href="/assets/js/10.94d9ae37.js"><link rel="prefetch" href="/assets/js/11.f71277c4.js"><link rel="prefetch" href="/assets/js/12.df91b8c5.js"><link rel="prefetch" href="/assets/js/13.ccf34248.js"><link rel="prefetch" href="/assets/js/14.cec430ee.js"><link rel="prefetch" href="/assets/js/15.075f2557.js"><link rel="prefetch" href="/assets/js/16.050b0744.js"><link rel="prefetch" href="/assets/js/17.e6b2d62e.js"><link rel="prefetch" href="/assets/js/18.e1f699c1.js"><link rel="prefetch" href="/assets/js/19.43923341.js"><link rel="prefetch" href="/assets/js/20.b20e711d.js"><link rel="prefetch" href="/assets/js/21.8dd3e2d2.js"><link rel="prefetch" href="/assets/js/22.bfe29ee7.js"><link rel="prefetch" href="/assets/js/23.d6610626.js"><link rel="prefetch" href="/assets/js/24.922a5ac7.js"><link rel="prefetch" href="/assets/js/25.082050c9.js"><link rel="prefetch" href="/assets/js/26.64d32bef.js"><link rel="prefetch" href="/assets/js/27.429314cf.js"><link rel="prefetch" href="/assets/js/28.6d085cc4.js"><link rel="prefetch" href="/assets/js/29.03a256fd.js"><link rel="prefetch" href="/assets/js/3.689860d5.js"><link rel="prefetch" href="/assets/js/30.1af4f8c4.js"><link rel="prefetch" href="/assets/js/31.5eec4937.js"><link rel="prefetch" href="/assets/js/32.b31e0c94.js"><link rel="prefetch" href="/assets/js/33.0057f8d5.js"><link rel="prefetch" href="/assets/js/34.1c144145.js"><link rel="prefetch" href="/assets/js/35.997e4046.js"><link rel="prefetch" href="/assets/js/36.73c2dac3.js"><link rel="prefetch" href="/assets/js/37.0efd73ec.js"><link rel="prefetch" href="/assets/js/38.d3b0fd9d.js"><link rel="prefetch" href="/assets/js/4.8c775bf3.js"><link rel="prefetch" href="/assets/js/40.3f735ee0.js"><link rel="prefetch" href="/assets/js/41.0b3072ca.js"><link rel="prefetch" href="/assets/js/42.f2deac56.js"><link rel="prefetch" href="/assets/js/43.2925ac95.js"><link rel="prefetch" href="/assets/js/44.15b774a6.js"><link rel="prefetch" href="/assets/js/45.4a73b893.js"><link rel="prefetch" href="/assets/js/46.ff126056.js"><link rel="prefetch" href="/assets/js/47.a8af33bb.js"><link rel="prefetch" href="/assets/js/48.fd9bfbfb.js"><link rel="prefetch" href="/assets/js/49.d1bb8a6b.js"><link rel="prefetch" href="/assets/js/5.4038169b.js"><link rel="prefetch" href="/assets/js/50.261e0b1b.js"><link rel="prefetch" href="/assets/js/51.ad5e908a.js"><link rel="prefetch" href="/assets/js/52.30dae559.js"><link rel="prefetch" href="/assets/js/53.5928da48.js"><link rel="prefetch" href="/assets/js/54.b392dbf9.js"><link rel="prefetch" href="/assets/js/55.02dbfb4e.js"><link rel="prefetch" href="/assets/js/6.bdb8c543.js"><link rel="prefetch" href="/assets/js/7.7ea37c1e.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.be90ab07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Homework 10</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/multivariate/hw10.html#_6-23" class="sidebar-link">6.23</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/multivariate/hw10.html#_6-31" class="sidebar-link">6.31</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">as</span> stats
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_6-23"><a href="#_6-23" class="header-anchor">#</a> 6.23</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./data/T11-5.DAT&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&quot;\s+&quot;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;sepal_length&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sepal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;petal_length&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;petal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;iris_class&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df_width <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;sepal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;petal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;iris_class&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>df_width_group <span class="token operator">=</span> df_width<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;iris_class&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>x_bar <span class="token operator">=</span> df_width<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;sepal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;petal_width&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_l_bar <span class="token operator">=</span> df_width_group<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
n_l <span class="token operator">=</span> df_width_group<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>B <span class="token operator">=</span> <span class="token punctuation">(</span>n_l<span class="token punctuation">.</span>values<span class="token punctuation">.</span>T <span class="token operator">*</span> <span class="token punctuation">(</span>x_l_bar <span class="token operator">-</span> x_bar<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x_l_bar <span class="token operator">-</span> x_bar<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>W <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    W <span class="token operator">+=</span> df_width_group<span class="token punctuation">.</span>get_group<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;sepal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;petal_width&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">*</span> n_l<span class="token punctuation">.</span>values<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;B:</span><span class="token interpolation"><span class="token punctuation">{</span>B<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;W:</span><span class="token interpolation"><span class="token punctuation">{</span>W<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;B+W:</span><span class="token interpolation"><span class="token punctuation">{</span>B<span class="token operator">+</span>W<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- extra-class"><pre><code>B:             sepal_width  petal_width
sepal_width    11.344933   -22.932667
petal_width   -22.932667    80.413333
W:             sepal_width  petal_width
sepal_width      16.9620       4.8084
petal_width       4.8084       6.1566
B+W:             sepal_width  petal_width
sepal_width    28.306933   -18.124267
petal_width   -18.124267    86.569933
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp <span class="token operator">=</span> stats<span class="token punctuation">.</span>t<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token number">0.05</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">150</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>W<span class="token punctuation">.</span>values<span class="token punctuation">[</span>i<span class="token punctuation">,</span>i<span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">150</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">50</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;x_3</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">-x_1</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: (</span><span class="token interpolation"><span class="token punctuation">{</span>x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> temp<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">+</span> temp<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;x_2</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">-x_1</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: (</span><span class="token interpolation"><span class="token punctuation">{</span>x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> temp<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">+</span> temp<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;x_3</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">-x_2</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">: (</span><span class="token interpolation"><span class="token punctuation">{</span>x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> temp<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">-</span> x_l_bar<span class="token punctuation">.</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">+</span> temp<span class="token punctuation">}</span></span><span class="token string">)&quot;</span></span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>x_31-x_11: (-0.6356943622645526, -0.2723056377354478)
x_21-x_11: (-0.8396943622645523, -0.47630563773544754)
x_31-x_21: (0.02230563773544733, 0.3856943622645521)
x_32-x_12: (1.6705354763538884, 1.8894645236461112)
x_22-x_12: (0.9705354763538886, 1.1894645236461112)
x_32-x_22: (0.5905354763538887, 0.8094645236461112)
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>s_j <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s_j<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df_width_group<span class="token punctuation">.</span>get_group<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;sepal_width&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;petal_width&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span>ddof<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s_pool <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">149</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s_j<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">49</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s_j<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">49</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>s_j<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">49</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
l_star <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>s_j<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>s_j<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>s_j<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>s_pool<span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">149</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>l_star
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>6.7075040297093525e-09
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">49</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">147</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">6</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- extra-class"><pre><code>0.016628873771730914
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>chi <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">49</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">147</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">6</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>l_star<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>chi2<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">3</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>chi<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- extra-class"><pre><code>12.591587243743977
37.01416576211768
</code></pre></div><h2 id="_6-31"><a href="#_6-31" class="header-anchor">#</a> 6.31</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./data/T6-17.dat&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&quot;\s+&quot;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>df_f1 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">)</span>
df_f2 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;factor2&quot;</span><span class="token punctuation">)</span>
df_f1_f2 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>x_bar <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_l_bar <span class="token operator">=</span> df_f1<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_k_bar <span class="token operator">=</span> df_f2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
x_lk_bar <span class="token operator">=</span> df_f1_f2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
g <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> <span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>ss_f1 <span class="token operator">=</span> b <span class="token operator">*</span> n <span class="token operator">*</span> <span class="token punctuation">(</span>x_l_bar <span class="token operator">-</span> x_bar<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x_l_bar <span class="token operator">-</span> x_bar<span class="token punctuation">)</span>
ss_f2 <span class="token operator">=</span> g <span class="token operator">*</span> n <span class="token operator">*</span> <span class="token punctuation">(</span>x_k_bar <span class="token operator">-</span> x_bar<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x_k_bar <span class="token operator">-</span> x_bar<span class="token punctuation">)</span>
ss_interact <span class="token operator">=</span> n <span class="token operator">*</span> <span class="token punctuation">(</span>x_lk_bar <span class="token operator">-</span> x_l_bar <span class="token operator">-</span> x_k_bar <span class="token operator">+</span> x_bar<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>x_lk_bar <span class="token operator">-</span> x_l_bar <span class="token operator">-</span> x_k_bar <span class="token operator">+</span> x_bar<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_frame<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ss_residual <span class="token operator">=</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> x_lk_bar<span class="token punctuation">)</span><span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> x_lk_bar<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">print</span><span class="token punctuation">(</span>ss_f1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ss_f2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ss_interact<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ss_residual<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language- extra-class"><pre><code>           x1        x2          x3
x1   0.700833  -10.6575    7.129167
x2 -10.657500  162.0675 -108.412500
x3   7.129167 -108.4125   72.520833
          x1         x2          x3
x1  196.1150   365.1825   42.627500
x2  365.1825  1089.0150  414.655000
x3   42.6275   414.6550  284.101667
            x1        x2          x3
x1  205.101667  363.6675  107.785833
x2  363.667500  780.6950  254.220000
x3  107.785833  254.2200   85.951667
         x1       x2       x3
x1  104.205   49.365   76.480
x2   49.365  352.105  121.995
x3   76.480  121.995   94.835
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>p <span class="token operator">=</span> <span class="token number">3</span>
l_star <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>ss_residual<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>ss_residual <span class="token operator">+</span> ss_interact<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>l_star<span class="token punctuation">)</span>
chi <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>g <span class="token operator">*</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>l_star<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>chi2<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>chi<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language- extra-class"><pre><code>0.07429984180628003
12.591587243743977
12.998232281910447
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>l_star <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>ss_residual<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>ss_f1 <span class="token operator">+</span> ss_residual<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>l_star<span class="token punctuation">)</span>
chi <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>g <span class="token operator">*</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>l_star<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>chi2<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>chi<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>0.10651619790519301
7.814727903251179
10.077561955760036
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>l_star <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>ss_residual<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>det<span class="token punctuation">(</span>ss_f2 <span class="token operator">+</span> ss_residual<span class="token punctuation">)</span><span class="token punctuation">)</span>
chi <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>g <span class="token operator">*</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token operator">-</span><span class="token punctuation">(</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>l_star<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>l_star<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>chi2<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token punctuation">(</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>chi<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language- extra-class"><pre><code>0.012444166211401582
12.591587243743977
21.932516716427894
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">two_way_univariate_ANOVA_f</span><span class="token punctuation">(</span>col<span class="token punctuation">,</span> df1<span class="token punctuation">)</span><span class="token punctuation">:</span>
    df1_f1 <span class="token operator">=</span> df1<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">)</span>
    df1_f2 <span class="token operator">=</span> df1<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;factor2&quot;</span><span class="token punctuation">)</span>
    df1_f1_f2 <span class="token operator">=</span> df1<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    x1_bar <span class="token operator">=</span> df1<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x1_l_bar <span class="token operator">=</span> df1_f1<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x1_k_bar <span class="token operator">=</span> df1_f2<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x1_lk_bar <span class="token operator">=</span> df1_f1_f2<span class="token punctuation">[</span>col<span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
    g1 <span class="token operator">=</span> df1<span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span>
    b1 <span class="token operator">=</span> df1<span class="token punctuation">[</span><span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span>
    n1 <span class="token operator">=</span> <span class="token number">2</span>
    ss_interact1 <span class="token operator">=</span> n1 <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x1_lk_bar <span class="token operator">-</span> x1_l_bar <span class="token operator">-</span> x1_k_bar <span class="token operator">+</span> x1_bar<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
    df1<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>MultiIndex<span class="token punctuation">.</span>from_frame<span class="token punctuation">(</span>df1<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    ss_residual1 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>df1<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">-</span> x1_lk_bar<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
    df1 <span class="token operator">=</span> df1<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    f_critical <span class="token operator">=</span> stats<span class="token punctuation">.</span>f<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> dfn<span class="token operator">=</span><span class="token punctuation">(</span>g1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dfd<span class="token operator">=</span>g1<span class="token operator">*</span>b1<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>ss_interact1 <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>g1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>ss_residual1 <span class="token operator">/</span> <span class="token punctuation">(</span>g1<span class="token operator">*</span>b1<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ss_interact1<span class="token punctuation">,</span> ss_residual1<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./data/T6-17.dat&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&quot;\s+&quot;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x1_anova <span class="token operator">=</span> two_way_univariate_ANOVA_f<span class="token punctuation">(</span><span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./data/T6-17.dat&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&quot;\s+&quot;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x2_anova <span class="token operator">=</span> two_way_univariate_ANOVA_f<span class="token punctuation">(</span><span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;./data/T6-17.dat&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&quot;\s+&quot;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x3_anova <span class="token operator">=</span> two_way_univariate_ANOVA_f<span class="token punctuation">(</span><span class="token string">&quot;x3&quot;</span><span class="token punctuation">,</span> df<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>x1_anova<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x2_anova<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x3_anova<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>stats<span class="token punctuation">.</span>f<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">0.95</span><span class="token punctuation">,</span> dfn<span class="token operator">=</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dfd<span class="token operator">=</span>g<span class="token operator">*</span>b<span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language- extra-class"><pre><code>[5.904755050141562, 205.1016666666667, 104.20499999999976]
[6.651666406327646, 780.6949999999981, 352.1049999999998]
[2.718985606579845, 85.95166666666654, 94.83500000000001]
5.143252849784718
</code></pre></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>df2 <span class="token operator">=</span> df_f1<span class="token punctuation">.</span>get_group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
df2_f2 <span class="token operator">=</span> df2<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;factor1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;factor2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&quot;factor2&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>df2_f2<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> df2_f2<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> stats<span class="token punctuation">.</span>t<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token number">0.05</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>x1</th> <th>x2</th> <th>x3</th></tr> <tr><th>factor2</th> <th></th> <th></th> <th></th></tr></thead> <tbody><tr><th>5</th> <td>7.473664</td> <td>-221.033826</td> <td>-161.995949</td></tr> <tr><th>6</th> <td>102.769429</td> <td>81.844813</td> <td>-63.043647</td></tr> <tr><th>8</th> <td>172.108656</td> <td>36.640392</td> <td>24.092695</td></tr></tbody></table></div> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df2_f2<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> df2_f2<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> stats<span class="token punctuation">.</span>t<span class="token punctuation">.</span>ppf<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> <span class="token number">0.05</span><span class="token operator">/</span><span class="token number">6</span><span class="token punctuation">,</span> df<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div><style scoped="scoped">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;!--beforebegin--&gt;&lt;div class=&quot;language- extra-class&quot;&gt;&lt;!--afterbegin--&gt;&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;!--beforeend--&gt;&lt;/div&gt;&lt;!--afterend--&gt;</style> <table border="1" class="dataframe"><thead><tr style="text-align:right;"><th></th> <th>x1</th> <th>x2</th> <th>x3</th></tr> <tr><th>factor2</th> <th></th> <th></th> <th></th></tr></thead> <tbody><tr><th>5</th> <td>362.626336</td> <td>481.633826</td> <td>261.895949</td></tr> <tr><th>6</th> <td>297.530571</td> <td>246.055187</td> <td>177.543647</td></tr> <tr><th>8</th> <td>229.391344</td> <td>303.959608</td> <td>108.107305</td></tr></tbody></table></div> <div class="language-python line-numbers-mode"><pre class="language-python"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c81839fd.js" defer></script><script src="/assets/js/2.1ffc7243.js" defer></script><script src="/assets/js/1.21765641.js" defer></script><script src="/assets/js/39.1f488157.js" defer></script>
  </body>
</html>
